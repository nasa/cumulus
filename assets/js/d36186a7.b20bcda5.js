"use strict";(self.webpackChunk_cumulus_website=self.webpackChunk_cumulus_website||[]).push([[47029],{15680:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>m});var i=t(96540);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},u=Object.keys(e);for(i=0;i<u.length;i++)t=u[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(i=0;i<u.length;i++)t=u[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var r=i.createContext({}),s=function(e){var n=i.useContext(r),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=s(e.components);return i.createElement(r.Provider,{value:n},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},g=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,u=e.originalType,r=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),c=s(t),g=a,m=c["".concat(r,".").concat(g)]||c[g]||p[g]||u;return t?i.createElement(m,l(l({ref:n},d),{},{components:t})):i.createElement(m,l({ref:n},d))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var u=t.length,l=new Array(u);l[0]=g;var o={};for(var r in n)hasOwnProperty.call(n,r)&&(o[r]=n[r]);o.originalType=e,o[c]="string"==typeof e?e:a,l[1]=o;for(var s=2;s<u;s++)l[s]=t[s];return i.createElement.apply(null,l)}return i.createElement.apply(null,t)}g.displayName="MDXCreateElement"},38320:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var i=t(58168),a=t(98587),u=(t(96540),t(15680)),l=["components"],o={id:"upgrade_execution_table_CUMULUS_3320",title:"Upgrade execution table to CUMULUS-3320",hide_title:!1},r=void 0,s={unversionedId:"upgrade-notes/upgrade_execution_table_CUMULUS_3320",id:"version-v18.4.0/upgrade-notes/upgrade_execution_table_CUMULUS_3320",title:"Upgrade execution table to CUMULUS-3320",description:"Background",source:"@site/versioned_docs/version-v18.4.0/upgrade-notes/upgrade-execution-table-CUMULUS-3320.md",sourceDirName:"upgrade-notes",slug:"/upgrade-notes/upgrade_execution_table_CUMULUS_3320",permalink:"/cumulus/docs/v18.4.0/upgrade-notes/upgrade_execution_table_CUMULUS_3320",draft:!1,tags:[],version:"v18.4.0",lastUpdatedBy:"Naga Nages",lastUpdatedAt:1724446966,formattedLastUpdatedAt:"Aug 23, 2024",frontMatter:{id:"upgrade_execution_table_CUMULUS_3320",title:"Upgrade execution table to CUMULUS-3320",hide_title:!1},sidebar:"docs",previous:{title:"Update Cumulus_id Type and Indexes",permalink:"/cumulus/docs/v18.4.0/upgrade-notes/update-cumulus_id-type-indexes-CUMULUS-3449"},next:{title:"External Contributions",permalink:"/cumulus/docs/v18.4.0/category/external-contributions"}},d={},c=[{value:"Background",id:"background",level:2},{value:"Adding the <code>executions_parent_cumulus_id_index</code> index",id:"adding-the-executions_parent_cumulus_id_index-index",level:2},{value:"Reasoning",id:"reasoning",level:3},{value:"Procedure",id:"procedure",level:3},{value:"Utilize the normal cumulus deployment",id:"utilize-the-normal-cumulus-deployment",level:4},{value:"Manually create the index",id:"manually-create-the-index",level:4},{value:"Create index (executions_parent_cumulus_id_index) with ingest halted",id:"create-index-executions_parent_cumulus_id_index-with-ingest-halted",level:5},{value:"Create index concurrently/with ongoing ingest",id:"create-index-concurrentlywith-ongoing-ingest",level:5},{value:"Indexing Failure",id:"indexing-failure",level:4},{value:"Adding the <code>executions_collection_cumulus_id_index</code> index",id:"adding-the-executions_collection_cumulus_id_index-index",level:2},{value:"Reasoning",id:"reasoning-1",level:3},{value:"Procedure",id:"procedure-1",level:3},{value:"Utilize the normal cumulus deployment",id:"utilize-the-normal-cumulus-deployment-1",level:4},{value:"Manually create the index",id:"manually-create-the-index-1",level:4},{value:"Create index with ingest halted",id:"create-index-with-ingest-halted",level:5},{value:"Indexing Failure",id:"indexing-failure-1",level:4},{value:"Updating the <code>executions_parent_cumulus_id_foreign</code> constraint",id:"updating-the-executions_parent_cumulus_id_foreign-constraint",level:2},{value:"<em>Notes</em>",id:"notes",level:3},{value:"Reasoning",id:"reasoning-2",level:3},{value:"Procedure",id:"procedure-2",level:3},{value:"Utilize the normal cumulus deployment",id:"utilize-the-normal-cumulus-deployment-2",level:4},{value:"Manually update the constraint",id:"manually-update-the-constraint",level:4},{value:"Modify the existing constraint without validation",id:"modify-the-existing-constraint-without-validation",level:5},{value:"Re-validate the constraint",id:"re-validate-the-constraint",level:4},{value:"Verify the constraint/indexes exist on the table",id:"verify-the-constraintindexes-exist-on-the-table",level:2},{value:"PSQL terminal",id:"psql-terminal",level:3},{value:"Standard Postgres queries",id:"standard-postgres-queries",level:3},{value:"Verify executions_parent_cumulus_id_foreign",id:"verify-executions_parent_cumulus_id_foreign",level:4},{value:"Verify indexes were created",id:"verify-indexes-were-created",level:4}],p={toc:c},g="wrapper";function m(e){var n=e.components,t=(0,a.A)(e,l);return(0,u.yg)(g,(0,i.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,u.yg)("h2",{id:"background"},"Background"),(0,u.yg)("p",null,"As part of the performance/feature evaluation work in completing the update requested as part of CUMULUS-3320, several updates were required to make ",(0,u.yg)("inlineCode",{parentName:"p"},"executions")," table deletes/reads more performant."),(0,u.yg)("p",null,"These changes required creating new indexes and modifying a table constraint - operations which can take some time and require manual upgrade steps for database deployments where the updates will exceed the bootstrap lambda's 15 minute timeout."),(0,u.yg)("p",null," Please note that testing in a production-similar environment is ",(0,u.yg)("em",{parentName:"p"},"strongly")," advised if you are concerned about precise query times and/or downtime."),(0,u.yg)("p",null,"The following procedures detail how this upgrade may be performed:"),(0,u.yg)("h2",{id:"adding-the-executions_parent_cumulus_id_index-index"},"Adding the ",(0,u.yg)("inlineCode",{parentName:"h2"},"executions_parent_cumulus_id_index")," index"),(0,u.yg)("h3",{id:"reasoning"},"Reasoning"),(0,u.yg)("p",null,"This index is required to support effective deletion of records. Our query analysis implies the same table foreign-key constraint results in a slow table scan to enforce the constraint for each deletion."),(0,u.yg)("h3",{id:"procedure"},"Procedure"),(0,u.yg)("p",null,"Users may opt to either automatically migrate the database, or manually create the index:"),(0,u.yg)("h4",{id:"utilize-the-normal-cumulus-deployment"},"Utilize the normal cumulus deployment"),(0,u.yg)("p",null,"The cumulus module will run the migrations on the database when it's deployed.   For databases with smaller holdings and not under heavy load such that the sum of the migrations to be run will complete in < 15 minutes, the migration will run the following SQL query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE INDEX CONCURRENTLY IF NOT EXISTS executions_parent_cumulus_id_index ON executions(parent_cumulus_id)'\n")),(0,u.yg)("h4",{id:"manually-create-the-index"},"Manually create the index"),(0,u.yg)("h5",{id:"create-index-executions_parent_cumulus_id_index-with-ingest-halted"},"Create index (executions_parent_cumulus_id_index) with ingest halted"),(0,u.yg)("p",null,"The recommended approach to create the index is to halt ingest activity that requires write access to the execution table, then run the query to create the index.  This will result in a much faster index operation than attempting to create the index concurrently, however the table will be locked until the index is complete."),(0,u.yg)("p",null,"For reference, in testing, using a 4ACU Aurora Serverless V1 cluster on a table with 15 million rows this migration took roughly 2 minutes to complete."),(0,u.yg)("p",null,"To do this, use the following query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE INDEX executions_parent_cumulus_id_index ON executions(parent_cumulus_id)'\n")),(0,u.yg)("h5",{id:"create-index-concurrentlywith-ongoing-ingest"},"Create index concurrently/with ongoing ingest"),(0,u.yg)("p",null,"The required index can also be created while the database is in use ",(0,u.yg)("em",{parentName:"p"},"prior to installing the upgrade containing CUMULUS-3320")," by running the following query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE INDEX CONCURRENTLY executions_parent_cumulus_id_index ON executions(parent_cumulus_id)'\n")),(0,u.yg)("p",null,"Please note this may take ",(0,u.yg)("em",{parentName:"p"},"significantly")," longer than creating the index non-concurrently, especially if the table is under heavy use."),(0,u.yg)("h4",{id:"indexing-failure"},"Indexing Failure"),(0,u.yg)("p",null,"If the concurrent index query fails for any reason, you may have an ",(0,u.yg)("inlineCode",{parentName:"p"},"invalid")," index - if this occurs, make sure to drop and/or recreate the index to avoid resources being used for the invalid index:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"DROP INDEX CONCURRENTLY executions_parent_cumulus_id_index\n")),(0,u.yg)("p",null,"The index operation can then be re-attempted."),(0,u.yg)("h2",{id:"adding-the-executions_collection_cumulus_id_index-index"},"Adding the ",(0,u.yg)("inlineCode",{parentName:"h2"},"executions_collection_cumulus_id_index")," index"),(0,u.yg)("h3",{id:"reasoning-1"},"Reasoning"),(0,u.yg)("p",null,"This index is required to support effective execution searches by ",(0,u.yg)("inlineCode",{parentName:"p"},"cumulus_collection_id")),(0,u.yg)("h3",{id:"procedure-1"},"Procedure"),(0,u.yg)("p",null,"Users may opt to either automatically migrate the database, or manually create the index:"),(0,u.yg)("h4",{id:"utilize-the-normal-cumulus-deployment-1"},"Utilize the normal cumulus deployment"),(0,u.yg)("p",null,"The cumulus module will run the migrations on the database when it's deployed.   For databases with smaller holdings and not under heavy load such that the sum of the migrations to be run will complete in < 15 minutes, the migration will run the following SQL query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE INDEX CONCURRENTLY IF NOT EXISTS executions_collection_cumulus_id_index ON executions(collection_cumulus_id)\n")),(0,u.yg)("h4",{id:"manually-create-the-index-1"},"Manually create the index"),(0,u.yg)("h5",{id:"create-index-with-ingest-halted"},"Create index with ingest halted"),(0,u.yg)("p",null,"The recommended approach to create the index is to halt ingest activity that requires write access to the execution table, then run the query to create the index.  This will result in a much faster index operation than attempting to create the index concurrently, however the table will be locked until the index is complete."),(0,u.yg)("p",null,"For reference, in testing, using a 4ACU Aurora Serverless V1 cluster on a table with 15 million rows this migration took roughly 3 minutes to complete."),(0,u.yg)("p",null,"To do this, use the following query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE INDEX executions_collection_cumulus_id_index ON executions(collection_cumulus_id)\n")),(0,u.yg)("p",null,"The required index can also be created while the database is in use ",(0,u.yg)("em",{parentName:"p"},"prior to installing the upgrade containing CUMULUS-3320")," by running the following query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE INDEX CONCURRENTLY executions_collection_cumulus_id_index ON executions(collection_cumulus_id)\n")),(0,u.yg)("p",null,"Please note this may take ",(0,u.yg)("em",{parentName:"p"},"significantly")," longer than creating the index non-concurrently, especially if the table is under heavy use."),(0,u.yg)("h4",{id:"indexing-failure-1"},"Indexing Failure"),(0,u.yg)("p",null,"If the concurrent index query fails for any reason, you may have an ",(0,u.yg)("inlineCode",{parentName:"p"},"invalid")," index - if this occurs, make sure to drop and/or recreate the index to avoid resources being used for the invalid index:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"DROP INDEX CONCURRENTLY executions_collection_cumulus_id_index\n")),(0,u.yg)("p",null,"The index operation can then be re-attempted."),(0,u.yg)("h2",{id:"updating-the-executions_parent_cumulus_id_foreign-constraint"},"Updating the ",(0,u.yg)("inlineCode",{parentName:"h2"},"executions_parent_cumulus_id_foreign")," constraint"),(0,u.yg)("h3",{id:"notes"},(0,u.yg)("em",{parentName:"h3"},"Notes")),(0,u.yg)("ul",null,(0,u.yg)("li",{parentName:"ul"},"This update may require ingest downtime as updates to the table require some time.   See instructions below."),(0,u.yg)("li",{parentName:"ul"},"This update should be performed after adding the ",(0,u.yg)("inlineCode",{parentName:"li"},"executions_parent_cumulus_id_foreign")," constraint")),(0,u.yg)("h3",{id:"reasoning-2"},"Reasoning"),(0,u.yg)("p",null,"This constraint as exists provides no action on deletion, this results in deletion of parent-child execution trees being both onerous and non-performant.   During work/evaluation for the CUMULUS-3320 feature implementation it was determined that adding ",(0,u.yg)("inlineCode",{parentName:"p"},"ON DELETE SET NULL")," to this key makes wholesale/bulk deletes relatively performant (when combined with an index on the field) for large numbers of records while also being acceptable for 3rd party/smaller RESTful queries."),(0,u.yg)("h3",{id:"procedure-2"},"Procedure"),(0,u.yg)("p",null,"Users may opt to either:"),(0,u.yg)("h4",{id:"utilize-the-normal-cumulus-deployment-2"},"Utilize the normal cumulus deployment"),(0,u.yg)("p",null,"The cumulus module will run the migrations on the database when it's deployed.   For databases with smaller holdings and not under heavy load such that the sum of the migrations to be run will complete in < 15 minutes, the migration will run the following SQL query ",(0,u.yg)("em",{parentName:"p"},"inside a transaction"),".   This query will write-lock the table, which may cause write failures due to timeouts if ingest is ongoing:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE executions DROP CONSTRAINT IF EXISTS executions_parent_cumulus_id_foreign\nALTER TABLE executions ADD CONSTRAINT executions_parent_cumulus_id_foreign FOREIGN KEY (parent_cumulus_id) REFERENCES executions(cumulus_id) ON DELETE SET NULL';\n")),(0,u.yg)("h4",{id:"manually-update-the-constraint"},"Manually update the constraint"),(0,u.yg)("p",null,"To manually update the constraint, do the following, in order:"),(0,u.yg)("h5",{id:"modify-the-existing-constraint-without-validation"},"Modify the existing constraint without validation"),(0,u.yg)("p",null,"The following query will, in a transaction, remove the existing constraint and re-enable the updated constraint.   Adding ",(0,u.yg)("inlineCode",{parentName:"p"},"NOT VALID")," to the creation will cause postgres not to validate values in existing rows, but will enforce them for new rows.    This ",(0,u.yg)("em",{parentName:"p"},"greatly")," reduces downtime requirements as the constraint can be validated while the table is in use, and this transaction should be extremely quick:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"BEGIN;\nALTER TABLE executions DROP CONSTRAINT IF EXISTS executions_parent_cumulus_id_foreign;\nALTER TABLE executions ADD CONSTRAINT executions_parent_cumulus_id_foreign FOREIGN KEY (parent_cumulus_id) REFERENCES executions(cumulus_id) ON DELETE SET NULL NOT VALID;\nEND;\n")),(0,u.yg)("h4",{id:"re-validate-the-constraint"},"Re-validate the constraint"),(0,u.yg)("p",null,"This query can be run at any time following the above step and will not lock the full table for new row inserts/selects:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE executions VALIDATE CONSTRAINT executions_parent_cumulus_id_foreign\n")),(0,u.yg)("p",null,"For reference, in a table of roughly 18 million records without active ingest running on a Serverless V1 cluster set at 4ACUs, this validation took roughly 2 minutes in repeated testing, however running the validation during simulated active heavy writes it took significantly longer at around 20 minutes."),(0,u.yg)("h2",{id:"verify-the-constraintindexes-exist-on-the-table"},"Verify the constraint/indexes exist on the table"),(0,u.yg)("p",null,"To validate the upgrades have completed, use one of the following options:"),(0,u.yg)("h3",{id:"psql-terminal"},"PSQL terminal"),(0,u.yg)("p",null,"If you're using a PSQL connection to the DB, you can get a full output of table structures and constraints using ",(0,u.yg)("inlineCode",{parentName:"p"},"\\d"),":"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"\\d executions\n")),(0,u.yg)("p",null,"resulting in:"),(0,u.yg)("p",null,"example"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-text"},'some_db=> \\d executions\n                                                   Table "public.executions"\n           Column           |           Type           | Collation | Nullable |                    Default\n----------------------------+--------------------------+-----------+----------+------------------------------------------------\n cumulus_id                 | bigint                   |           | not null | nextval(\'executions_cumulus_id_seq\'::regclass)\n arn                        | text                     |           | not null |\n async_operation_cumulus_id | integer                  |           |          |\n collection_cumulus_id      | integer                  |           |          |\n parent_cumulus_id          | bigint                   |           |          |\n cumulus_version            | text                     |           |          |\n url                        | text                     |           |          |\n status                     | text                     |           | not null |\n tasks                      | jsonb                    |           |          |\n error                      | jsonb                    |           |          |\n workflow_name              | text                     |           |          |\n duration                   | real                     |           |          |\n original_payload           | jsonb                    |           |          |\n final_payload              | jsonb                    |           |          |\n timestamp                  | timestamp with time zone |           |          |\n created_at                 | timestamp with time zone |           | not null | CURRENT_TIMESTAMP\n updated_at                 | timestamp with time zone |           | not null | CURRENT_TIMESTAMP\nIndexes:\n    "executions_pkey" PRIMARY KEY, btree (cumulus_id)\n    "executions_arn_unique" UNIQUE CONSTRAINT, btree (arn)\n    "executions_collection_cumulus_id_index" btree (collection_cumulus_id)\n    "executions_parent_cumulus_id_index" btree (parent_cumulus_id)\n    "executions_url_unique" UNIQUE CONSTRAINT, btree (url)\nCheck constraints:\n    "executions_status_check" CHECK (status = ANY (ARRAY[\'running\'::text, \'completed\'::text, \'failed\'::text, \'unknown\'::text]))\nForeign-key constraints:\n    "executions_async_operation_cumulus_id_foreign" FOREIGN KEY (async_operation_cumulus_id) REFERENCES async_operations(cumulus_id)\n    "executions_collection_cumulus_id_foreign" FOREIGN KEY (collection_cumulus_id) REFERENCES collections(cumulus_id)\n    "executions_parent_cumulus_id_foreign" FOREIGN KEY (parent_cumulus_id) REFERENCES executions(cumulus_id) ON DELETE SET NULL\nReferenced by:\n    TABLE "executions" CONSTRAINT "executions_parent_cumulus_id_foreign" FOREIGN KEY (parent_cumulus_id) REFERENCES executions(cumulus_id) ON DELETE SET NULL\n')),(0,u.yg)("p",null,"Check that the ",(0,u.yg)("inlineCode",{parentName:"p"},"executions_parent_cumulus_id_foreign")," constraint is present with 'ON DELETE SET_NULL' and does not have 'NOT VALID' appended to the end"),(0,u.yg)("p",null,"Check that the two added indexes ",(0,u.yg)("inlineCode",{parentName:"p"},"executions_parent_cumulus_id_index")," and ",(0,u.yg)("inlineCode",{parentName:"p"},"executions_collection_cumulus_id_index")," exist and do not show as ",(0,u.yg)("inlineCode",{parentName:"p"},"INVALID"),"."),(0,u.yg)("h3",{id:"standard-postgres-queries"},"Standard Postgres queries"),(0,u.yg)("h4",{id:"verify-executions_parent_cumulus_id_foreign"},"Verify executions_parent_cumulus_id_foreign"),(0,u.yg)("p",null,"Run the following query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    conname AS constraint_name,\n    pg_get_constraintdef(pg_constraint.oid) AS definition\nFROM\n    pg_constraint\nWHERE\n    conrelid = 'executions'::regclass\n    AND contype = 'f';\n")),(0,u.yg)("p",null,"You should get a result like:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-text"},"                constraint_name                |                                      definition\n-----------------------------------------------+--------------------------------------------------------------------------------------\n executions_async_operation_cumulus_id_foreign | FOREIGN KEY (async_operation_cumulus_id) REFERENCES async_operations(cumulus_id)\n executions_collection_cumulus_id_foreign      | FOREIGN KEY (collection_cumulus_id) REFERENCES collections(cumulus_id)\n executions_parent_cumulus_id_foreign          | FOREIGN KEY (parent_cumulus_id) REFERENCES executions(cumulus_id) ON DELETE SET NULL\n(3 rows)\n")),(0,u.yg)("p",null,"Check that the ",(0,u.yg)("inlineCode",{parentName:"p"},"executions_parent_cumulus_id_foreign")," constraint is present with 'ON DELETE SET_NULL' and does not have 'NOT VALID' appended to the end"),(0,u.yg)("h4",{id:"verify-indexes-were-created"},"Verify indexes were created"),(0,u.yg)("p",null,"Run the following query:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    indexname AS index_name,\n    indexdef AS definition\nFROM\n    pg_indexes\nWHERE\n    tablename = '<tablename>';\n")),(0,u.yg)("p",null,"You should see a result like:"),(0,u.yg)("pre",null,(0,u.yg)("code",{parentName:"pre",className:"language-test"},"               index_name               |                                                  definition\n----------------------------------------+--------------------------------------------------------------------------------------------------------------\n executions_url_unique                  | CREATE UNIQUE INDEX executions_url_unique ON public.executions USING btree (url)\n executions_arn_unique                  | CREATE UNIQUE INDEX executions_arn_unique ON public.executions USING btree (arn)\n executions_pkey                        | CREATE UNIQUE INDEX executions_pkey ON public.executions USING btree (cumulus_id)\n executions_collection_cumulus_id_index | CREATE INDEX executions_collection_cumulus_id_index ON public.executions USING btree (collection_cumulus_id)\n executions_parent_cumulus_id_index     | CREATE INDEX executions_parent_cumulus_id_index ON public.executions USING btree (parent_cumulus_id)\n(5 rows)\n")),(0,u.yg)("p",null,"Check that the two added indexes ",(0,u.yg)("inlineCode",{parentName:"p"},"executions_parent_cumulus_id_index")," and ",(0,u.yg)("inlineCode",{parentName:"p"},"executions_collection_cumulus_id_index")," exist and do not show as ",(0,u.yg)("inlineCode",{parentName:"p"},"INVALID"),"."))}m.isMDXComponent=!0}}]);