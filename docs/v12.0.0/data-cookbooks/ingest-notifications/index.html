<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v12.0.0 plugin-docs plugin-id-default docs-doc-id-data-cookbooks/ingest-notifications" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Ingest Notification in Workflows | Cumulus Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nasa.github.io/cumulus/docs/v12.0.0/data-cookbooks/ingest-notifications"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v12.0.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v12.0.0"><meta data-rh="true" name="docsearch:version" content="v12.0.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v12.0.0"><meta data-rh="true" property="og:title" content="Ingest Notification in Workflows | Cumulus Documentation"><meta data-rh="true" name="description" content="On deployment, an SQS queue and three SNS topics, one for executions, granules, and PDRs, are created and used for handling notification messages related to the workflow."><meta data-rh="true" property="og:description" content="On deployment, an SQS queue and three SNS topics, one for executions, granules, and PDRs, are created and used for handling notification messages related to the workflow."><link data-rh="true" rel="icon" href="/cumulus/img/cumulus.ico"><link data-rh="true" rel="canonical" href="https://nasa.github.io/cumulus/docs/v12.0.0/data-cookbooks/ingest-notifications"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v12.0.0/data-cookbooks/ingest-notifications" hreflang="en"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v12.0.0/data-cookbooks/ingest-notifications" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KBWSJQ0LBW-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Cumulus Documentation" href="/cumulus/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/cumulus/assets/css/styles.d37fa5d4.css">
<link rel="preload" href="/cumulus/assets/js/runtime~main.161c80b0.js" as="script">
<link rel="preload" href="/cumulus/assets/js/main.70c70581.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cumulus/"><div class="navbar__logo"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA" height="32" width="32"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU" height="32" width="32"></div><b class="navbar__title text--truncate">Cumulus Documentation</b></a><a href="https://nasa.github.io/cumulus-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://nasa.github.io/cumulus-distribution-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Distribution API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/cumulus/docs/v12.0.0/">Developer Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cumulus/docs/v12.0.0/data-cookbooks/about-cookbooks">Data Cookbooks</a><a class="navbar__item navbar__link" href="/cumulus/docs/v12.0.0/operator-docs/about-operator-docs">Operator Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/cumulus/docs/v12.0.0/">v12.0.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/cumulus/docs/next/data-cookbooks/ingest-notifications">Next</a></li><li><a class="dropdown__link" href="/cumulus/docs/data-cookbooks/ingest-notifications">v19.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v19.0.0/data-cookbooks/ingest-notifications">v19.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.5.0/data-cookbooks/ingest-notifications">v18.5.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.4.0/data-cookbooks/ingest-notifications">v18.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.3.4/data-cookbooks/ingest-notifications">v18.3.4</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.2.0/data-cookbooks/ingest-notifications">v18.2.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.1.0/data-cookbooks/ingest-notifications">v18.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.0.0/data-cookbooks/ingest-notifications">v18.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v17.0.0/data-cookbooks/ingest-notifications">v17.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.1.3/data-cookbooks/ingest-notifications">v16.1.3</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.0.0/data-cookbooks/ingest-notifications">v16.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v15.0.2/data-cookbooks/ingest-notifications">v15.0.2</a></li><li><a class="dropdown__link" href="/cumulus/docs/v14.1.0/data-cookbooks/ingest-notifications">v14.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.4.0/data-cookbooks/ingest-notifications">v13.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.0.0/data-cookbooks/ingest-notifications">v13.0.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cumulus/docs/v12.0.0/data-cookbooks/ingest-notifications">v12.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.1.0/data-cookbooks/ingest-notifications">v11.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.0.0/data-cookbooks/ingest-notifications">v11.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.1.0/data-cookbooks/ingest-notifications">v10.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.0.0/data-cookbooks/ingest-notifications">v10.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.9.0/data-cookbooks/ingest-notifications">v9.9.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.0.0/data-cookbooks/ingest-notifications">v9.0.0</a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/cumulus/versions">All versions</a></li></ul></div><a href="https://github.com/nasa/cumulus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="Cumulus Core GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v12.0.0/data-cookbooks/about-cookbooks">About Cookbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cumulus/docs/v12.0.0/data-cookbooks/hello-world">Cookbooks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/hello-world">HelloWorld Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/ingest-notifications">Ingest Notification in Workflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/sips-workflow">Science Investigator-led Processing Systems (SIPS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/cnm-workflow">CNM Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/error-handling">Error Handling in Workflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/choice-states">Choice States</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/browse-generation">Ingest Browse Generation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/tracking-files">Tracking Ancillary Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/run-tasks-in-lambda-or-docker">Run Step Function Tasks in AWS Lambda or Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/throttling-queued-executions">Throttling queued executions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v12.0.0/data-cookbooks/queue-post-to-cmr">Queue PostToCmr</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cumulus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cookbooks</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ingest Notification in Workflows</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v12.0.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ingest Notification in Workflows</h1></header><p>On deployment, an <a href="https://aws.amazon.com/sqs/" target="_blank" rel="noopener noreferrer">SQS queue</a> and three <a href="https://aws.amazon.com/sns/" target="_blank" rel="noopener noreferrer">SNS topics</a>, one for executions, granules, and PDRs, are created and used for handling notification messages related to the workflow.</p><p>The ingest notification reporting SQS queue is populated via a <a href="https://docs.aws.amazon.com/step-functions/latest/dg/cw-events.html" target="_blank" rel="noopener noreferrer">Cloudwatch rule for any Step Function execution state transitions</a>. The <code>sfEventSqsToDbRecords</code> Lambda consumes this queue. The queue and Lambda are included in the <code>cumulus</code> module and the Cloudwatch rule in the <code>workflow</code> module and are included by default in a Cumulus deployment.</p><p>The <code>sfEventSqsToDbRecords</code> Lambda function reads from the <code>sfEventSqsToDbRecordsInputQueue</code> queue and updates the RDS database records for granules, executions, and PDRs. When the records are updated, messages are posted to the three SNS topics. This Lambda is invoked both when the workflow starts and when it reaches a terminal state (completion or failure).</p><p><img loading="lazy" alt="Diagram of architecture for reporting workflow ingest notifications from AWS Step Functions" src="/cumulus/assets/images/interfaces-afde22eec1363772c777174b43895b47.svg" width="2286" height="1031" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sending-sqs-messages-to-report-status">Sending SQS messages to report status<a href="#sending-sqs-messages-to-report-status" class="hash-link" aria-label="Direct link to Sending SQS messages to report status" title="Direct link to Sending SQS messages to report status">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="publishing-granulepdr-reports-directly-to-the-sqs-queue">Publishing granule/PDR reports directly to the SQS queue<a href="#publishing-granulepdr-reports-directly-to-the-sqs-queue" class="hash-link" aria-label="Direct link to Publishing granule/PDR reports directly to the SQS queue" title="Direct link to Publishing granule/PDR reports directly to the SQS queue">​</a></h3><p>If you have a non-Cumulus workflow or process ingesting data and would like to update the status of your granules or PDRs, you can publish directly to the reporting SQS queue. Publishing messages to this queue will result in those messages being stored as granule/PDR records in the Cumulus database and having the status of those granules/PDRs being visible on the Cumulus dashboard. The queue does have certain expectations as it expects a Cumulus Message nested within a Cloudwatch Step Function Event object.</p><p>Posting directly to the queue will require knowing the queue URL. Assuming that you are using the <a href="https://github.com/nasa/cumulus/blob/master/tf-modules/cumulus" target="_blank" rel="noopener noreferrer"><code>cumulus</code> module</a> for your deployment, you can get the queue URL by adding them to <code>outputs.tf</code> for your Terraform deployment <a href="https://github.com/nasa/cumulus/blob/master/example/cumulus-tf/outputs.tf" target="_blank" rel="noopener noreferrer">as in our example deployment</a>:</p><div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">output &quot;stepfunction_event_reporter_queue_url&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  value = module.cumulus.stepfunction_event_reporter_queue_url</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">output &quot;report_executions_sns_topic_arn&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  value = module.cumulus.report_executions_sns_topic_arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">output &quot;report_granules_sns_topic_arn&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  value = module.cumulus.report_executions_sns_topic_arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">output &quot;report_pdrs_sns_topic_arn&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  value = module.cumulus.report_pdrs_sns_topic_arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, when you run <code>terraform deploy</code>, you should see the topic ARNs printed to your console:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Outputs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">stepfunction_event_reporter_queue_url </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> https://sqs.us-east-1.amazonaws.com/xxxxxxxxx/</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">-sfEventSqsToDbRecordsInputQueue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">report_executions_sns_topic_arn </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> arn:aws:sns:us-east-1:xxxxxxxxx:</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">-report-executions-topic</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">report_granules_sns_topic_arn </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> arn:aws:sns:us-east-1:xxxxxxxxx:</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">-report-executions-topic</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">report_pdrs_sns_topic_arn </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> arn:aws:sns:us-east-1:xxxxxxxxx:</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">-report-pdrs-topic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once you have the queue URL, you can use the AWS SDK for your language of choice to publish messages to the topic. The expected format of these messages is that of a <a href="https://docs.aws.amazon.com/step-functions/latest/dg/cw-events.html" target="_blank" rel="noopener noreferrer">Cloudwatch Step Function event</a> containing a Cumulus message. For <code>SUCCEEDED</code> events, the Cumulus message is expected to be in <code>detail.output</code>. For all other events statuses, a Cumulus Message is expected in <code>detail.input</code>. The Cumulus Message populating these fields <strong>MUST</strong> be a JSON string, not an object. <strong>Messages that do not conform to the schemas will fail to be created as records</strong>.</p><p>If you are not seeing records persist to the database or show up in the Cumulus dashboard, you can investigate the Cloudwatch logs of the SQS consumer Lambda:</p><ul><li><code>/aws/lambda/&lt;prefix&gt;-sfEventSqsToDbRecords</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="in-a-workflow">In a workflow<a href="#in-a-workflow" class="hash-link" aria-label="Direct link to In a workflow" title="Direct link to In a workflow">​</a></h3><p>As described above, ingest notifications will automatically be published to the SNS topics on workflow start and completion/failure, so <strong>you should not include a workflow step to publish the initial or final status of your workflows</strong>.</p><p>However, if you want to report your ingest status at any point <strong>during a workflow execution</strong>, you can add a workflow step using the <code>SfSqsReport</code> Lambda. In the following example from <a href="https://github.com/nasa/cumulus/blob/master/example/cumulus-tf/parse_pdr_workflow.tf" target="_blank" rel="noopener noreferrer"><code>cumulus-tf/parse_pdr_workflow.tf</code></a>, the <code>ParsePdr</code> workflow is configured to use the <code>SfSqsReport</code> Lambda, primarily to update the PDR ingestion status.</p><blockquote><p>Note: <code>${sf_sqs_report_task_arn}</code> is an interpolated value referring to a Terraform resource. See the example deployment code for the <a href="https://github.com/nasa/cumulus/blob/master/example/cumulus-tf/parse_pdr_workflow.tf" target="_blank" rel="noopener noreferrer"><code>ParsePdr</code> workflow</a>.</p></blockquote><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;PdrStatusReport&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Parameters&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;cma&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;event.$&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;$&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;ReplaceConfig&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;FullMessage&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;task_config&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;cumulus_message&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;input&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;{$}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;ResultPath&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;${sf_sqs_report_task_arn}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Retry&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;ErrorEquals&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Lambda.ServiceException&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Lambda.AWSLambdaException&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Lambda.SdkClientException&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;IntervalSeconds&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;MaxAttempts&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;BackoffRate&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Catch&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;ErrorEquals&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;States.ALL&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;ResultPath&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;$.exception&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;Next&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;WorkflowFailed&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Next&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;WaitForSomeTime&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="subscribing-additional-listeners-to-sns-topics">Subscribing additional listeners to SNS topics<a href="#subscribing-additional-listeners-to-sns-topics" class="hash-link" aria-label="Direct link to Subscribing additional listeners to SNS topics" title="Direct link to Subscribing additional listeners to SNS topics">​</a></h2><p>Additional listeners to SNS topics can be configured in a <code>.tf</code> file for your Cumulus deployment. Shown below is configuration that subscribes an additional Lambda function (<code>test_lambda</code>) to receive messages from the <code>report_executions</code> SNS topic. To subscribe to the <code>report_granules</code> or <code>report_pdrs</code> SNS topics instead, simply replace <code>report_executions</code> in the code block below with either of those values.</p><div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource &quot;aws_lambda_function&quot; &quot;test_lambda&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  function_name    = &quot;${var.prefix}-testLambda&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  filename         = &quot;./testLambda.zip&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  source_code_hash = filebase64sha256(&quot;./testLambda.zip&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  handler          = &quot;index.handler&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  role             = module.cumulus.lambda_processing_role_arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  runtime          = &quot;nodejs10.x&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource &quot;aws_sns_topic_subscription&quot; &quot;test_lambda&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  topic_arn = module.cumulus.report_executions_sns_topic_arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  protocol  = &quot;lambda&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  endpoint  = aws_lambda_function.test_lambda.arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource &quot;aws_lambda_permission&quot; &quot;test_lambda&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  action        = &quot;lambda:InvokeFunction&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  function_name = aws_lambda_function.test_lambda.arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  principal     = &quot;sns.amazonaws.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  source_arn    = module.cumulus.report_executions_sns_topic_arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sns-message-format">SNS message format<a href="#sns-message-format" class="hash-link" aria-label="Direct link to SNS message format" title="Direct link to SNS message format">​</a></h3><p>Subscribers to the SNS topics can expect to find the published message in the <a href="https://docs.aws.amazon.com/lambda/latest/dg/eventsources.html#eventsources-sns" target="_blank" rel="noopener noreferrer">SNS event</a> at <code>Records[0].Sns.Message</code>. The message will be a JSON stringified version of the ingest notification record for an execution or a PDR. For granules, the message will be a JSON stringified object with ingest notification record in the <code>record</code> property and the event type as the <code>event</code> property.</p><p>The ingest notification record of the execution, granule, or PDR should conform to the <a href="https://github.com/nasa/cumulus/tree/master/packages/api/models/schemas.js" target="_blank" rel="noopener noreferrer">data model schema for the given record type</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>Workflows can be configured to send SQS messages at any point using the <code>sf-sqs-report</code> task.</p><p>Additional listeners can be easily configured to trigger when messages are sent to the SNS topics.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-03-10T00:04:48.000Z">Mar 10, 2023</time></b> by <b>jennyhliu</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cumulus/docs/v12.0.0/data-cookbooks/hello-world"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">HelloWorld Workflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cumulus/docs/v12.0.0/data-cookbooks/sips-workflow"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Science Investigator-led Processing Systems (SIPS)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sending-sqs-messages-to-report-status" class="table-of-contents__link toc-highlight">Sending SQS messages to report status</a><ul><li><a href="#publishing-granulepdr-reports-directly-to-the-sqs-queue" class="table-of-contents__link toc-highlight">Publishing granule/PDR reports directly to the SQS queue</a></li><li><a href="#in-a-workflow" class="table-of-contents__link toc-highlight">In a workflow</a></li></ul></li><li><a href="#subscribing-additional-listeners-to-sns-topics" class="table-of-contents__link toc-highlight">Subscribing additional listeners to SNS topics</a><ul><li><a href="#sns-message-format" class="table-of-contents__link toc-highlight">SNS message format</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/cumulus/assets/js/runtime~main.161c80b0.js"></script>
<script src="/cumulus/assets/js/main.70c70581.js"></script>
</body>
</html>