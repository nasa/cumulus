<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v18.3.4 plugin-docs plugin-id-default docs-doc-id-deployment/cumulus_distribution" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Using the Cumulus Distribution API | Cumulus Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nasa.github.io/cumulus/docs/v18.3.4/deployment/cumulus_distribution"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v18.3.4"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v18.3.4"><meta data-rh="true" name="docsearch:version" content="v18.3.4"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v18.3.4"><meta data-rh="true" property="og:title" content="Using the Cumulus Distribution API | Cumulus Documentation"><meta data-rh="true" name="description" content="The Cumulus Distribution API is a set of endpoints that can be used to enable AWS Cognito authentication when downloading data from S3."><meta data-rh="true" property="og:description" content="The Cumulus Distribution API is a set of endpoints that can be used to enable AWS Cognito authentication when downloading data from S3."><link data-rh="true" rel="icon" href="/cumulus/img/cumulus.ico"><link data-rh="true" rel="canonical" href="https://nasa.github.io/cumulus/docs/v18.3.4/deployment/cumulus_distribution"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v18.3.4/deployment/cumulus_distribution" hreflang="en"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v18.3.4/deployment/cumulus_distribution" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KBWSJQ0LBW-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Cumulus Documentation" href="/cumulus/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/cumulus/assets/css/styles.d37fa5d4.css">
<link rel="preload" href="/cumulus/assets/js/runtime~main.6d34a879.js" as="script">
<link rel="preload" href="/cumulus/assets/js/main.1257b213.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cumulus/"><div class="navbar__logo"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA" height="32" width="32"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU" height="32" width="32"></div><b class="navbar__title text--truncate">Cumulus Documentation</b></a><a href="https://nasa.github.io/cumulus-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://nasa.github.io/cumulus-distribution-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Distribution API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cumulus/docs/v18.3.4/">Developer Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cumulus/docs/v18.3.4/data-cookbooks/about-cookbooks">Data Cookbooks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cumulus/docs/v18.3.4/operator-docs/about-operator-docs">Operator Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/cumulus/docs/v18.3.4/">v18.3.4</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/cumulus/docs/next/deployment/cumulus_distribution">Next</a></li><li><a class="dropdown__link" href="/cumulus/docs/deployment/cumulus_distribution">v19.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.4.0/deployment/cumulus_distribution">v18.4.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cumulus/docs/v18.3.4/deployment/cumulus_distribution">v18.3.4</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.2.0/deployment/cumulus_distribution">v18.2.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.1.0/deployment/cumulus_distribution">v18.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.0.0/deployment/cumulus_distribution">v18.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v17.0.0/deployment/cumulus_distribution">v17.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.1.3/deployment/cumulus_distribution">v16.1.3</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.0.0/deployment/cumulus_distribution">v16.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v15.0.2/deployment/cumulus_distribution">v15.0.2</a></li><li><a class="dropdown__link" href="/cumulus/docs/v14.1.0/deployment/cumulus_distribution">v14.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.4.0/deployment/cumulus_distribution">v13.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.0.0/deployment/cumulus_distribution">v13.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v12.0.0/deployment/cumulus_distribution">v12.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.1.0/deployment/cumulus_distribution">v11.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.0.0/deployment/cumulus_distribution">v11.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.1.0/deployment/cumulus_distribution">v10.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.0.0/deployment/cumulus_distribution">v10.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.9.0/deployment/cumulus_distribution">v9.9.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.0.0/">v9.0.0</a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/cumulus/versions">All versions</a></li></ul></div><a href="https://github.com/nasa/cumulus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="Cumulus Core GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/faqs">Frequently Asked Questions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/about-cumulus">About Cumulus</a><button aria-label="Toggle the collapsible sidebar category &#x27;About Cumulus&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/interfaces">Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/team">Cumulus Team</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/deployment">Deployment</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/">How to Deploy Cumulus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/create_bucket">Creating an S3 Bucket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/terraform-best-practices">Terraform Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/components">Component-based Cumulus Deployment</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/databases-introduction">Databases</a><button aria-label="Toggle the collapsible sidebar category &#x27;Databases&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/postgres_database_deployment">PostgreSQL Database Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/choosing_configuring_rds">RDS: Choosing and Configuring Your Database Type</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/apis-introduction">APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/thin_egress_app">Using the Thin Egress App (TEA) for Cumulus Distribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/cumulus_distribution">Using the Cumulus Distribution API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/cumulus/docs/v18.3.4/category/logs">Logs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Logs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/api-gateway-logging">API Gateway Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/share-s3-access-logs">Share S3 Access Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/cloudwatch-logs-delivery">Configure Cloudwatch Logs Delivery</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/deployment/upgrade-readme">Upgrading Cumulus</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/configuration">Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/data-management-types">Cumulus Data Management Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/monitoring-readme">Monitoring Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/server_access_logging">S3 Server Access Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/cloudwatch-retention">Cloudwatch Retention</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/lifecycle-policies">Setting S3 Lifecycle Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/collection-storage-best-practices">Collection Cost Tracking and Storage Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/configuration/task-configuration">Configuration of Tasks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/developing-a-cumulus-workflow">Creating a Cumulus Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/developing-workflow-tasks">Developing Workflow Tasks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/lambda">Develop Lambda Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/docker">Dockerizing Data Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/workflow-configuration-how-to">Workflow Configuration How To&#x27;s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/adding-a-task">Contributing a Task</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/workflows">Workflows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Workflows&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/">Workflows Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/protocol">Workflow Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/input_output">Workflow Inputs &amp; Outputs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/workflow-triggers">Workflow Triggers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/message_granule_writes">Workflow Message Granule Writes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/cumulus/docs/v18.3.4/category/workflow-tasks">Workflow Tasks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Workflow Tasks&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/tasks">Cumulus Tasks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflows/cumulus-task-message-flow">Cumulus Tasks: Message Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflow_tasks/discover_granules">Discover Granules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflow_tasks/files_to_granules">Files To Granules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflow_tasks/move_granules">Move Granules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflow_tasks/queue_granules">Queue Granules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflow_tasks/lzards_backup">LZARDS Backup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/workflow_tasks/parse_pdr">Parse PDR</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/features">Features</a><button aria-label="Toggle the collapsible sidebar category &#x27;Features&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/backup_and_restore">Cumulus Backup and Restore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/dead_letter_queues">Dead Letter Queues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/dead_letter_archive">Cumulus Dead Letter Archive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/execution_payload_retention">Execution Payload Retention</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/reports">Reconciliation Reports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/ancillary_metadata">Ancillary Metadata Export</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/distribution-metrics">Cumulus Distribution Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/logging-esdis-metrics">Writing logs for ESDIS Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/replay-kinesis-messages">How to replay Kinesis messages after an outage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/features/replay-archived-sqs-messages">How to replay SQS messages archived in S3</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/troubleshooting/">How to Troubleshoot and Fix Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/troubleshooting/troubleshooting-deployment">Troubleshooting Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/troubleshooting/rerunning-workflow-executions">Rerunning workflow executions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/troubleshooting/reindex-elasticsearch">Reindexing Elasticsearch Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/cumulus-development">Cumulus Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cumulus Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/adding-a-task">Contributing a Task</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/docs-how-to">Cumulus Documentation: How To&#x27;s</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/integrator-guide">Integrator Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Integrator Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/integrator-guide/about-int-guide">About Integrator Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/integrator-guide/int-common-use-cases">Integrator Common Use Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/integrator-guide/workflow-add-new-lambda">Workflow - Add New Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/integrator-guide/workflow-ts-failed-step">Workflow - Troubleshoot Failed Step(s)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/upgrade-notes">Upgrade Notes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Upgrade Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/migrate_tea_standalone">Migrate TEA deployment to standalone module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/upgrade_tf_version_0.13.6">Upgrade to TF version 0.13.6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/upgrade_tf_version_1.5.3">Upgrade to TF version 1.5.3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/upgrade-rds">Upgrade to RDS release</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/cumulus_distribution_migration">Migrate from TEA deployment to Cumulus Distribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/update-task-file-schemas">Updates to task granule file schemas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/update-cma-2.0.2">Upgrade to CMA 2.0.2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/upgrade-rds-phase-3-release">Upgrade RDS Phase 3 Release</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/rds-phase-3-data-migration-guidance">Data Integrity &amp; Migration Guidance (RDS Phase 3 Upgrade)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/upgrade-notes/upgrade-rds-cluster-tf-postgres-13">Upgrade Database Cluster to PostgreSQL v13</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/category/external-contributions">External Contributions</a><button aria-label="Toggle the collapsible sidebar category &#x27;External Contributions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/external-contributions/">External Contributions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/data-cookbooks/about-cookbooks">Data Cookbooks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Cookbooks&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v18.3.4/data-cookbooks/about-cookbooks">About Cookbooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cumulus/docs/v18.3.4/category/cookbooks">Cookbooks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cookbooks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/cumulus/docs/v18.3.4/operator-docs/about-operator-docs">Operator Docs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator Docs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cumulus/docs/v18.3.4/category/configuration-1">Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cumulus/docs/v18.3.4/category/operations">Operations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cumulus/docs/v18.3.4/category/common-use-cases">Common Use Cases</a><button aria-label="Toggle the collapsible sidebar category &#x27;Common Use Cases&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cumulus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cumulus/docs/v18.3.4/category/deployment"><span itemprop="name">Deployment</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cumulus/docs/v18.3.4/deployment/apis-introduction"><span itemprop="name">APIs</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using the Cumulus Distribution API</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v18.3.4</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using the Cumulus Distribution API</h1></header><p>The Cumulus Distribution API is a set of endpoints that can be used to enable AWS Cognito authentication when downloading data from S3.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>If you need to access our quick reference materials while setting up or continuing to manage your API access go to the <a href="https://nasa.github.io/cumulus-distribution-api/" target="_blank" rel="noopener noreferrer">Cumulus Distribution API Docs</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-a-cumulus-distribution-deployment">Configuring a Cumulus Distribution Deployment<a href="#configuring-a-cumulus-distribution-deployment" class="hash-link" aria-label="Direct link to Configuring a Cumulus Distribution Deployment" title="Direct link to Configuring a Cumulus Distribution Deployment">​</a></h2><p>The Cumulus Distribution API is included in the main <a href="https://github.com/nasa/cumulus/tree/master/tf-modules/cumulus_distribution" target="_blank" rel="noopener noreferrer">Cumulus</a> repo. It is available as part of the <code>terraform-aws-cumulus.zip</code> archive in the <a href="https://github.com/nasa/cumulus/releases" target="_blank" rel="noopener noreferrer">latest release</a>.</p><p>These steps assume you&#x27;re using the <a href="https://github.com/nasa/cumulus-template-deploy/blob/master/cumulus-tf/main.tf" target="_blank" rel="noopener noreferrer">Cumulus Deployment Template</a> but they can also be used for custom deployments.</p><p>To configure a deployment to use Cumulus Distribution:</p><ol><li>Remove or comment the &quot;Thin Egress App Settings&quot; in the <a href="https://github.com/nasa/cumulus-template-deploy/blob/master/cumulus-tf/main.tf" target="_blank" rel="noopener noreferrer">Cumulus Template Deploy</a> and enable the &quot;Cumulus Distribution Settings&quot;.</li><li>Delete or comment the contents of <a href="https://github.com/nasa/cumulus-template-deploy/blob/master/cumulus-tf/thin_egress_app.tf" target="_blank" rel="noopener noreferrer">thin_egress_app.tf</a> and the corresponding Thin Egress App outputs in <a href="https://github.com/nasa/cumulus-template-deploy/blob/master/cumulus-tf/outputs.tf" target="_blank" rel="noopener noreferrer">outputs.tf</a>. These are not necessary for a Cumulus Distribution deployment.</li><li>Uncomment the Cumulus Distribution outputs in <a href="https://github.com/nasa/cumulus-template-deploy/blob/master/cumulus-tf/outputs.tf" target="_blank" rel="noopener noreferrer">outputs.tf</a>.</li><li>Rename <code>cumulus-template-deploy/cumulus-tf/cumulus_distribution.tf.example</code> to <code>cumulus-template-deploy/cumulus-tf/cumulus_distribution.tf</code>.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cognito-application-and-user-credentials">Cognito Application and User Credentials<a href="#cognito-application-and-user-credentials" class="hash-link" aria-label="Direct link to Cognito Application and User Credentials" title="Direct link to Cognito Application and User Credentials">​</a></h2><p>The major prerequisite for using the Cumulus Distribution API is to set up <a href="https://aws.amazon.com/cognito/" target="_blank" rel="noopener noreferrer">Cognito</a>. If operating within NGAP, this should already be done for you. If operating outside of NGAP, you must set up Cognito yourself, which is beyond the scope of this documentation.</p><p>Given that Cognito is set up, in order to be able to download granule files via the Cumulus Distribution API, you must obtain Cognito user credentials, because any attempt to download such files (that will be, or have been, published to the CMR via your Cumulus deployment) will result in a prompt for you to supply Cognito user credentials. To obtain your own user credentials, talk to your product owner or scrum master for additional information. They should either know how to create the credentials, know who can create them for the team, or be the liaison to the Cognito team.</p><p>Further, whoever helps to obtain your Cognito user credentials should also be able to supply you with the values for the following new variables that you must add to your <code>cumulus-tf/terraform.tfvars</code> file:</p><ul><li><code>csdap_host_url</code>: The URL of the Cognito service to which your Cumulus deployment will make Cognito API calls during a distribution (download) event</li><li><code>csdap_client_id</code>: The client ID for the Cumulus application registered within the Cognito service</li><li><code>csdap_client_password</code>: The client password for the Cumulus application registered within the Cognito service</li></ul><p>Although you might have to wait a bit for your Cognito user credentials, the remaining instructions do not depend upon having them, so you may continue with these instructions while waiting for your credentials.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cumulus-distribution-url">Cumulus Distribution URL<a href="#cumulus-distribution-url" class="hash-link" aria-label="Direct link to Cumulus Distribution URL" title="Direct link to Cumulus Distribution URL">​</a></h2><p>Your Cumulus Distribution URL is used by Cumulus to generate download URLs as part of the granule metadata generated and published to the CMR. For example, a granule download URL will be of the form <code>&lt;distribution url&gt;/&lt;protected bucket&gt;/&lt;key&gt;</code> (or <code>&lt;distribution url&gt;/path/to/file</code>, if using a custom bucket map, as explained further below).</p><p>By default, the value of your distribution URL is the URL of your private Cumulus Distribution API Gateway (the API Gateway named <code>&lt;prefix&gt;-distribution</code>, once you deploy the Cumulus Distribution module). Therefore, by default, the generated download URLs are private, and thus inaccessible directly, but there are 2 ways to address this issue (both of which are detailed below): (a) use tunneling (only in development) or (b) put an HTTPS CloudFront URL in front of your API Gateway (required in production, UAT, and SIT).</p><p>In either case, you must first know the default URL (i.e., the URL for the private Cumulus Distribution API Gateway). In order to obtain this default URL, you must first deploy your <code>cumulus-tf</code> module with the new Cumulus Distribution module, and once your initial deployment is complete, one of the Terraform outputs will be <code>cumulus_distribution_api_uri</code>, which is the URL for the private API Gateway.</p><p>You may override this default URL by adding a <code>cumulus_distribution_url</code> variable to your <code>cumulus-tf/terraform.tfvars</code> file and setting it to one of the following values (both are explained below):</p><ol><li>The default URL, but with a port added to it, in order to allow you to configure tunneling (only in development)</li><li>An HTTPS CloudFront URL placed in front of your Cumulus Distribution API Gateway (required in production environments)</li></ol><p>The following subsections explain these approaches in turn.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-your-cumulus-distribution-api-gateway-url-as-your-distribution-url">Using Your Cumulus Distribution API Gateway URL as Your Distribution URL<a href="#using-your-cumulus-distribution-api-gateway-url-as-your-distribution-url" class="hash-link" aria-label="Direct link to Using Your Cumulus Distribution API Gateway URL as Your Distribution URL" title="Direct link to Using Your Cumulus Distribution API Gateway URL as Your Distribution URL">​</a></h3><p>Since your Cumulus Distribution API Gateway URL is private, the only way you can use it to confirm that your integration with Cognito is working is by using tunneling (again, generally for development). Here is an outline of the required steps with details provided further below:</p><ol><li>Create/import a key pair into your AWS EC2 service (if you haven&#x27;t already done so), or setup auth using a PKCS11Provider</li><li>Add a reference to the name of the key pair to your Terraform variables (we&#x27;ll set the <code>key_name</code> Terraform variable)</li><li>Choose an open local port on your machine (we&#x27;ll use 9000 in the following example)</li><li>Add a reference to the value of your <code>cumulus_distribution_api_uri</code> (mentioned earlier), including your chosen port (we&#x27;ll set the <code>cumulus_distribution_url</code> Terraform variable)</li><li>Redeploy Cumulus</li><li>Add an entry to your <code>/etc/hosts</code> file</li><li>Add a redirect URI to Cognito via the Cognito API</li><li>Install the Session Manager Plugin for the AWS CLI (if you haven&#x27;t already done so; assuming you have already installed the AWS CLI)</li><li>Add a sample file to S3 to test downloading via Cognito</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-ssh-keypair">Setting up SSH Keypair<a href="#setting-up-ssh-keypair" class="hash-link" aria-label="Direct link to Setting up SSH Keypair" title="Direct link to Setting up SSH Keypair">​</a></h3><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Setting up a keypair is optional if your organization is making use of alternative authentication mechanisms built into the AMI</p></div></div><p>To create or import an existing key pair, you can use the AWS CLI (see AWS <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/import-key-pair.html" target="_blank" rel="noopener noreferrer">ec2 import-key-pair</a>), or the AWS Console (see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener noreferrer">Amazon EC2 key pairs and Linux instances</a>).</p><p>Once your key pair is added to AWS, add the following to your <code>cumulus-tf/terraform.tfvars</code> file:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">key_name = &quot;&lt;name&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cumulus_distribution_url = &quot;https://&lt;id&gt;.execute-api.&lt;region&gt;.amazonaws.com:&lt;port&gt;/dev/&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where:</p><ul><li><code>&lt;name&gt;</code> is the name of the key pair you just added to AWS</li><li><code>&lt;id&gt;</code> and <code>&lt;region&gt;</code> are the corresponding parts from your <code>cumulus_distribution_api_uri</code> output variable</li><li><code>&lt;port&gt;</code> is your open local port of choice (9000 is typically a good choice)</li></ul><p>Once you save your variable changes, redeploy your <code>cumulus-tf</code> module.</p><p>While your deployment runs, add the following entry to your <code>/etc/hosts</code> file, replacing <code>&lt;hostname&gt;</code> with the host name of the <code>cumulus_distribution_url</code> Terraform variable you just added above:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">localhost &lt;hostname&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, you&#x27;ll need to use the Cognito API to add the value of your <code>cumulus_distribution_url</code> Terraform variable as a Cognito redirect URI. To do so, use your favorite tool (e.g., curl, wget, Postman, etc.) to make a BasicAuth request to the Cognito API, using the following details:</p><ul><li>method: POST</li><li>base URL: the value of your <code>csdap_host_url</code> Terraform variable</li><li>path: /authclient/updateRedirectUri</li><li>username: the value of your <code>csdap_client_id</code> Terraform variable</li><li>password: the value of your <code>csdap_client_password</code> Terraform variable</li><li>headers: Content-Type=&#x27;application/x-www-form-urlencoded&#x27;</li><li>body: redirect_uri=&lt;cumulus_distribution_url&gt;/login</li></ul><p>where <code>&lt;cumulus_distribution_url&gt;</code> is the value of your <code>cumulus_distribution_url</code> Terraform variable. Note the <code>/login</code> path at the end of the <code>redirect_uri</code> value.</p><p>For reference, see the <a href="https://wiki.earthdata.nasa.gov/display/ACAS/Cognito+Authentication+Service+API" target="_blank" rel="noopener noreferrer">Cognito Authentication Service API</a>.</p><p>Next, <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html" target="_blank" rel="noopener noreferrer">install the Session Manager Plugin for the AWS CLI</a>. If running on macOS, and you use Homebrew, you can install it simply as follows:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --cask session-manager-plugin --no-quarantine</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As your final setup step, add a sample file to one of the protected buckets listed in your <code>buckets</code> Terraform variable in your <code>cumulus-tf/terraform.tfvars</code> file. The key for the S3 object doesn&#x27;t matter, nor does it matter what file you use. All that matters is that the file is an S3 object in one of your protected buckets, because Cognito is triggered when attempting to download from one of those buckets.</p><p>At this point, you should be ready to open a tunnel and attempt to download your sample file via your browser, summarized as follows:</p><ol><li>Determine your EC2 instance ID</li><li>Connect to the NASA VPN</li><li>Start an AWS SSM session</li><li>Open an SSH tunnel</li><li>Use a browser to navigate to your file</li></ol><p>To determine your EC2 instance ID for your Cumulus deployment, run the follow command where <code>&lt;profile&gt;</code> is the name of the appropriate AWS profile to use, and <code>&lt;prefix&gt;</code> is the value of your <code>prefix</code> Terraform variable:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws --profile </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">profile</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> ec2 describe-instances --filters </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">Name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">tag:Deployment,Values</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">Name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">instance-state-name,Values</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">running --query </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Reservations[0].Instances[].InstanceId&quot;</span><span class="token plain"> --output text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Connect to NASA VPN</div><div class="admonitionContent_S0QG"><p>Before proceeding with the remaining steps, make sure you are connected to the NASA VPN.</p></div></div><p>Use the value output from the command above in place of <code>&lt;id&gt;</code> in the following command, which will start an SSM session:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws ssm start-session --target </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> --document-name AWS-StartPortForwardingSession --parameters </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">portNumber</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">22</span><span class="token plain">,localPortNumber</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">6000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If successful, you should see output similar to the following:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Starting session with SessionId: NGAPShApplicationDeveloper-***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Port 6000 opened for sessionId NGAPShApplicationDeveloper-***.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Waiting for connections...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In another terminal window, open a tunnel with port forwarding using your chosen port from above (e.g., 9000):</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-ssh-keypair-authentication">Using SSH keypair authentication<a href="#using-ssh-keypair-authentication" class="hash-link" aria-label="Direct link to Using SSH keypair authentication" title="Direct link to Using SSH keypair authentication">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ssh</span><span class="token plain"> -4 -p </span><span class="token number" style="color:rgb(247, 140, 108)">6000</span><span class="token plain"> -N -L </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">port</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">api-gateway-host</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:443 ec2-user@127.0.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="using-pkcs11provider">Using PKCS11Provider<a href="#using-pkcs11provider" class="hash-link" aria-label="Direct link to Using PKCS11Provider" title="Direct link to Using PKCS11Provider">​</a></h5><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ssh</span><span class="token plain"> -4 -I /usr/lib/ssh-keychain.dylib -p </span><span class="token number" style="color:rgb(247, 140, 108)">6000</span><span class="token plain"> -N -L </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">port</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">api-gateway-host</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">:443 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">userid</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">@127.0.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where:</p><ul><li><code>&lt;port&gt;</code> is the open local port you chose earlier (e.g., 9000)</li><li><code>&lt;api-gateway-host&gt;</code> is the hostname of your private API Gateway (i.e., the host portion of the URL you used as the value of your <code>cumulus_distribution_url</code> Terraform variable above)</li></ul><p>Finally, use your chosen browser to navigate to <code>&lt;cumulus_distribution_url&gt;/&lt;bucket&gt;/&lt;key&gt;</code>, where <code>&lt;bucket&gt;</code> and <code>&lt;key&gt;</code> reference the sample file you added to S3 above.</p><p>If all goes well, you should be prompted for your Cognito username and password. If you have obtained your Cognito user credentials, enter them, and then next enter a code generated by the authenticator application you registered at the time you completed your Cognito registration process. Once your credentials and auth code are correctly supplied, after a few moments, the download process will begin.</p><p>Once you&#x27;re finished testing, clean up as follows:</p><ol><li>Stop your SSH tunnel (enter <code>Ctrl-C</code>)</li><li>Stop your AWS SSM session (enter <code>Ctrl-C</code>)</li><li>If you like, disconnect from the NASA VPN</li></ol><p>While this is a relatively lengthy process, things are much easier when using CloudFront, such as in Production (OPS), SIT, or UAT, as explained next.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-cloudfront-url-as-your-distribution-url">Using a CloudFront URL as Your Distribution URL<a href="#using-a-cloudfront-url-as-your-distribution-url" class="hash-link" aria-label="Direct link to Using a CloudFront URL as Your Distribution URL" title="Direct link to Using a CloudFront URL as Your Distribution URL">​</a></h3><p>In Production (OPS), and in other environments, such as UAT and SIT, you&#x27;ll need to provide a publicly accessible URL for users to use for downloading (distributing) granule files.</p><p>This is generally done by placing a CloudFront URL in front of your private Cumulus Distribution API Gateway. In order to create such a CloudFront URL, contact the person who helped you obtain your Cognito credentials, and request a CloudFront URL with the following details:</p><ul><li>The private, backing URL, which is the value of your <code>cumulus_distribution_api_uri</code> Terraform output value</li><li>A request to add the AWS account&#x27;s VPC to the whitelist</li></ul><p>Once this request is completed, and you obtain the new CloudFront URL, override your default distribution URL with the CloudFront URL by adding the following to your <code>cumulus-tf/terraform.tfvars</code> file:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cumulus_distribution_url = &lt;cloudfront_url&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In addition, add a Cognito redirect URI, as detailed in the <a href="#using-your-cumulus-distribution-api-gateway-url-as-your-distribution-url">previous section</a>. Note that in this case, the value you&#x27;ll use for <code>redirect_uri</code> is <code>&lt;cloudfront_url&gt;/login</code> since the value of your <code>cumulus_distribution_url</code> is now your CloudFront URL.</p><p>At this point, it is assumed that you have added the appropriate values for this environment for the variables described at the top (<code>csdap_host_url</code>, <code>csdap_client_id</code>, and <code>csdap_client_password</code>).</p><p>Redeploy Cumulus with your new/updated Terraform variables.</p><p>As your final setup step, add a sample file to one of the protected buckets listed in your <code>buckets</code> Terraform variable in your <code>cumulus-tf/terraform.tfvars</code> file. The key for the S3 object doesn&#x27;t matter, nor does it matter what file you use. All that matters is that the file is an S3 object in one of your protected buckets, because Cognito is triggered when attempting to download from one of those buckets.</p><p>Finally, use your chosen browser to navigate to <code>&lt;cumulus_distribution_url&gt;/&lt;bucket&gt;/&lt;key&gt;</code>, where <code>&lt;bucket&gt;</code> and <code>&lt;key&gt;</code> reference the sample file you added to S3.</p><p>If all goes well, you should be prompted for your Cognito username and password. If you have obtained your Cognito user credentials, enter them, followed by entering a code generated by the authenticator application you registered at the time you completed your Cognito registration process. Once your credentials and auth code are correctly supplied, after a few moments, the download process will begin.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="s3-bucket-mapping">S3 Bucket Mapping<a href="#s3-bucket-mapping" class="hash-link" aria-label="Direct link to S3 Bucket Mapping" title="Direct link to S3 Bucket Mapping">​</a></h2><p>An S3 Bucket map allows users to abstract bucket names. If the bucket names change at any point, only the bucket map would need to be updated instead of every S3 link.</p><p>The Cumulus Distribution API uses a <code>bucket_map.yaml</code> or <code>bucket_map.yaml.tmpl</code> file to determine which buckets to
serve. <a href="https://github.com/nasa/cumulus/tree/master/example/cumulus-tf/cumulus_distribution" target="_blank" rel="noopener noreferrer">See the examples</a>.</p><p>The default Cumulus module generates a file at <code>s3://${system_bucket}/distribution_bucket_map.json</code>.</p><p>The configuration file is a simple JSON mapping of the form:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;daac-public-data-bucket&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/path/to/this/kind/of/data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>cumulus bucket mapping</div><div class="admonitionContent_S0QG"><p>Cumulus only supports a one-to-one mapping of bucket -&gt; Cumulus Distribution path for &#x27;distribution&#x27; buckets. Also, the bucket map <strong>must include mappings for all of the <code>protected</code> and <code>public</code> buckets specified in the <code>buckets</code> variable in <code>cumulus-tf/terraform.tfvars</code></strong>, otherwise Cumulus may not be able to determine the correct distribution URL for ingested files and you may encounter errors.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="switching-from-the-thin-egress-app-to-cumulus-distribution">Switching from the Thin Egress App to Cumulus Distribution<a href="#switching-from-the-thin-egress-app-to-cumulus-distribution" class="hash-link" aria-label="Direct link to Switching from the Thin Egress App to Cumulus Distribution" title="Direct link to Switching from the Thin Egress App to Cumulus Distribution">​</a></h2><p>If you have previously deployed the <a href="/cumulus/docs/v18.3.4/deployment/thin_egress_app">Thin Egress App (TEA)</a> as your distribution app, you can switch to Cumulus Distribution by following the steps above.</p><p>Note, however, that the <code>cumulus_distribution</code> module will generate a bucket map cache and overwrite any existing bucket map caches created by TEA.</p><p>There will also be downtime while your API Gateway is updated.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-08-28T17:03:26.000Z">Aug 28, 2024</time></b> by <b>Paul Pilone</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cumulus/docs/v18.3.4/deployment/thin_egress_app"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Using the Thin Egress App (TEA) for Cumulus Distribution</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cumulus/docs/v18.3.4/category/logs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Logs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuring-a-cumulus-distribution-deployment" class="table-of-contents__link toc-highlight">Configuring a Cumulus Distribution Deployment</a></li><li><a href="#cognito-application-and-user-credentials" class="table-of-contents__link toc-highlight">Cognito Application and User Credentials</a></li><li><a href="#cumulus-distribution-url" class="table-of-contents__link toc-highlight">Cumulus Distribution URL</a><ul><li><a href="#using-your-cumulus-distribution-api-gateway-url-as-your-distribution-url" class="table-of-contents__link toc-highlight">Using Your Cumulus Distribution API Gateway URL as Your Distribution URL</a></li><li><a href="#setting-up-ssh-keypair" class="table-of-contents__link toc-highlight">Setting up SSH Keypair</a></li><li><a href="#using-a-cloudfront-url-as-your-distribution-url" class="table-of-contents__link toc-highlight">Using a CloudFront URL as Your Distribution URL</a></li></ul></li><li><a href="#s3-bucket-mapping" class="table-of-contents__link toc-highlight">S3 Bucket Mapping</a></li><li><a href="#switching-from-the-thin-egress-app-to-cumulus-distribution" class="table-of-contents__link toc-highlight">Switching from the Thin Egress App to Cumulus Distribution</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/cumulus/assets/js/runtime~main.6d34a879.js"></script>
<script src="/cumulus/assets/js/main.1257b213.js"></script>
</body>
</html>