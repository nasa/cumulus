<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v10.1.0 plugin-docs plugin-id-default docs-doc-id-development/release" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Versioning and Releases | Cumulus Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nasa.github.io/cumulus/docs/v10.1.0/development/release"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v10.1.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v10.1.0"><meta data-rh="true" name="docsearch:version" content="v10.1.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v10.1.0"><meta data-rh="true" property="og:title" content="Versioning and Releases | Cumulus Documentation"><meta data-rh="true" name="description" content="Versioning"><meta data-rh="true" property="og:description" content="Versioning"><link data-rh="true" rel="icon" href="/cumulus/img/cumulus.ico"><link data-rh="true" rel="canonical" href="https://nasa.github.io/cumulus/docs/v10.1.0/development/release"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v10.1.0/development/release" hreflang="en"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v10.1.0/development/release" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KBWSJQ0LBW-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Cumulus Documentation" href="/cumulus/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/cumulus/assets/css/styles.d37fa5d4.css">
<link rel="preload" href="/cumulus/assets/js/runtime~main.6d34a879.js" as="script">
<link rel="preload" href="/cumulus/assets/js/main.1257b213.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cumulus/"><div class="navbar__logo"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA" height="32" width="32"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU" height="32" width="32"></div><b class="navbar__title text--truncate">Cumulus Documentation</b></a><a href="https://nasa.github.io/cumulus-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://nasa.github.io/cumulus-distribution-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Distribution API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/cumulus/docs/v10.1.0/">Developer Docs</a><a class="navbar__item navbar__link" href="/cumulus/docs/v10.1.0/data-cookbooks/about-cookbooks">Data Cookbooks</a><a class="navbar__item navbar__link" href="/cumulus/docs/v10.1.0/operator-docs/about-operator-docs">Operator Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/cumulus/docs/v10.1.0/">v10.1.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/cumulus/docs/next/development/release">Next</a></li><li><a class="dropdown__link" href="/cumulus/docs/development/release">v19.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.4.0/development/release">v18.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.3.4/development/release">v18.3.4</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.2.0/development/release">v18.2.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.1.0/development/release">v18.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.0.0/development/release">v18.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v17.0.0/development/release">v17.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.1.3/development/release">v16.1.3</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.0.0/development/release">v16.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v15.0.2/development/release">v15.0.2</a></li><li><a class="dropdown__link" href="/cumulus/docs/v14.1.0/development/release">v14.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.4.0/development/release">v13.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.0.0/development/release">v13.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v12.0.0/development/release">v12.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.1.0/development/release">v11.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.0.0/development/release">v11.0.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cumulus/docs/v10.1.0/development/release">v10.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.0.0/development/release">v10.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.9.0/development/release">v9.9.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.0.0/development/release">v9.0.0</a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/cumulus/versions">All versions</a></li></ul></div><a href="https://github.com/nasa/cumulus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="Cumulus Core GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><span class="theme-doc-version-badge badge badge--secondary">Version: v10.1.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Versioning and Releases</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="versioning">Versioning<a href="#versioning" class="hash-link" aria-label="Direct link to Versioning" title="Direct link to Versioning">​</a></h2><p>We use a global versioning approach, meaning version numbers in cumulus are consistent across all packages and tasks, and semantic versioning to track major, minor, and patch version (i.e. 1.0.0). We use Lerna to manage our versioning. Any change will force lerna to increment the version of all packages.</p><p>Read more about the semantic versioning <a href="https://docs.npmjs.com/getting-started/semantic-versioning" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-release-testing">Pre-release testing<a href="#pre-release-testing" class="hash-link" aria-label="Direct link to Pre-release testing" title="Direct link to Pre-release testing">​</a></h2><blockquote><p>Note: This is only necessary when preparing a release for a new major version of Cumulus (e.g. preparing to go from <code>6.x.x</code> to <code>7.0.0</code>)</p></blockquote><p>Before releasing a new major version of Cumulus, we should test the deployment upgrade path from the latest release of Cumulus to the upcoming release.</p><p>It is preferable to use the <a href="https://github.com/nasa/cumulus-template-deploy" target="_blank" rel="noopener noreferrer">cumulus-template-deploy</a> repo for testing the deployment, since that repo is the officially recommended deployment configuration for end users.</p><p>You should create an entirely new deployment for this testing to replicate the end user upgrade path. Using an existing test or CI deployment would not be useful because that deployment may already have been deployed with the latest changes and not match the upgrade path for end users.</p><p>Pre-release testing steps:</p><ol><li><p>Checkout the <a href="https://github.com/nasa/cumulus-template-deploy" target="_blank" rel="noopener noreferrer">cumulus-template-deploy</a> repo</p></li><li><p>Update the deployment code to use the latest release artifacts if it wasn&#x27;t done already. For example, assuming that the latest release was <code>5.0.1</code>, update the deployment files as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in data-persistence-tf/main.tf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source = &quot;https://github.com/nasa/cumulus/releases/download/v5.0.1/terraform-aws-cumulus.zip//tf-modules/data-persistence&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in cumulus-tf/main.tf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source = &quot;https://github.com/nasa/cumulus/releases/download/v5.0.1/terraform-aws-cumulus.zip//tf-modules/cumulus&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>For both the <code>data-persistence-tf</code> and <code>cumulus-tf</code> modules:</p><ol><li>Add the necessary backend configuration (<code>terraform.tf</code>) and variables (<code>terraform.tfvars</code>)<ul><li>You should use an entirely new deployment for this testing, so make sure to use values for <code>key</code> in <code>terraform.tf</code> and <code>prefix</code> in <code>terraform.tfvars</code> that don&#x27;t collide with existing deployments</li></ul></li><li>Run <code>terraform init</code></li><li>Run <code>terraform apply</code></li></ol></li><li><p>Checkout the <code>master</code> branch of the <code>cumulus</code> repo</p></li><li><p>Run a full bootstrap of the code: <code>npm run bootstrap</code></p></li><li><p>Build the pre-release artifacts: <code>./bamboo/create-release-artifacts.sh</code></p></li><li><p>For both the <code>data-persistence-tf</code> and <code>cumulus-tf</code> modules:</p><ol><li><p>Update the deployment to use the built release artifacts:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in data-persistence-tf/main.tf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source = &quot;[path]/cumulus/terraform-aws-cumulus.zip//tf-modules/data-persistence&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in cumulus-tf/main.tf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source = &quot;/Users/mboyd/development/cumulus/terraform-aws-cumulus.zip//tf-modules/cumulus&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Review the <code>CHANGELOG.md</code> for any pre-deployment migration steps. If there are, go through the steps and confirm that they are successful</p></li><li><p>Run <code>terraform init</code></p></li><li><p>Run <code>terraform apply</code></p></li></ol></li><li><p>Review the <code>CHANGELOG.md</code> for any post-deployment migration steps and confirm that they are successful</p></li><li><p>Delete your test deployment by running <code>terraform destroy</code> in <code>cumulus-tf</code> and <code>data-persistence-tf</code></p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updating-cumulus-version-and-publishing-to-npm">Updating Cumulus version and publishing to NPM<a href="#updating-cumulus-version-and-publishing-to-npm" class="hash-link" aria-label="Direct link to Updating Cumulus version and publishing to NPM" title="Direct link to Updating Cumulus version and publishing to NPM">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-a-branch-for-the-new-release">1. Create a branch for the new release<a href="#1-create-a-branch-for-the-new-release" class="hash-link" aria-label="Direct link to 1. Create a branch for the new release" title="Direct link to 1. Create a branch for the new release">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="from-master">From Master<a href="#from-master" class="hash-link" aria-label="Direct link to From Master" title="Direct link to From Master">​</a></h4><p>Create a branch titled <code>release-MAJOR.MINOR.x</code> for the release (use a literal x for the patch version).</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout -b release-MAJOR.MINOR.x</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">e.g.:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout -b release-9.1.x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If creating a new major version release from master, say <code>5.0.0</code>, then the branch would be named <code>release-5.0.x</code>. If creating a new minor version release from master, say <code>1.14.0</code> then the branch would be named <code>release-1.14.x</code>.</p><p>Having a release branch for each major/minor version allows us to easily backport patches to that version.</p><p>Push the <code>release-MAJOR.MINOR.x</code> branch to GitHub if it was created locally. (Commits should be even with master at this point.)</p><p>If creating a patch release, you can check out the existing base branch.</p><p>Then create the release branch (e.g. <code>release-1.14.0</code>) from the minor version base branch. For example, from the <code>release-1.14.x</code> branch:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout -b release-1.14.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="backporting">Backporting<a href="#backporting" class="hash-link" aria-label="Direct link to Backporting" title="Direct link to Backporting">​</a></h4><p>When creating a backport, a minor version base branch should already exist on GitHub. Check out the existing minor version base branch then create a release branch from it. For example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># check out existing minor version base branch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout release-1.14.x</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># pull to ensure you have the latest changes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> pull origin release-1.14.x</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># create new release branch for backport</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout -b release-1.14.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># cherry pick the commits (or single squashed commit of changes) relevant to the backport</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> cherry-pick </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">replace-with-commit-SHA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># push up the changes to the release branch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-update-the-cumulus-version-number">2. Update the Cumulus version number<a href="#2-update-the-cumulus-version-number" class="hash-link" aria-label="Direct link to 2. Update the Cumulus version number" title="Direct link to 2. Update the Cumulus version number">​</a></h3><p>When changes are ready to be released, the Cumulus version number must be updated.</p><p>Lerna handles the process of deciding which version number should be used as long as the developer specifies whether the change is a major, minor, or patch change.</p><p>To update Cumulus&#x27;s version number run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run update</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://static.notion-static.com/13acbe0a-c59d-4c42-90eb-23d4ec65c9db/Screen_Shot_2018-03-15_at_12.21.16_PM.png" alt="Screenshot of terminal showing interactive prompt from Lerna for selecting the new release version" class="img_ev3q"></p><p>Lerna will handle updating the packages and all of the dependent package version numbers. If a dependency has not been changed with the update, however, lerna will not update the version of the dependency.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2b-verify-lerna">2B. Verify Lerna<a href="#2b-verify-lerna" class="hash-link" aria-label="Direct link to 2B. Verify Lerna" title="Direct link to 2B. Verify Lerna">​</a></h4><p><strong>Note:</strong> Lerna can struggle to correctly update the versions on any non-standard/alpha versions (e.g. <code>1.17.0-alpha0</code>). Additionally some packages may have been left at the previous version.
Please be sure to check any packages that are new or have been manually published since the previous release and any packages that list it as a dependency to ensure the listed versions are correct.
It&#x27;s useful to use the search feature of your code editor or <code>grep</code> to see if there any references to the <strong><em>old</em></strong> package versions.
In bash shell you can run</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">find</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> -name package.json -exec </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> -nH </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@cumulus/.*MAJOR\.MINOR\.PATCH.*&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify that each of those is updated to the <strong><em>new</em></strong> <code>MAJOR.MINOR.PATCH</code> verion you are trying to release.</p><p>A similar search for alpha and beta versions should be run on the release version and any problems should be fixed.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">find</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> -name package.json -exec </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> -nHE </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MAJOR\.MINOR\.PATCH.*(alpha|beta)&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-check-cumulus-dashboard-prs-for-version-bump">3. Check Cumulus Dashboard PRs for Version Bump<a href="#3-check-cumulus-dashboard-prs-for-version-bump" class="hash-link" aria-label="Direct link to 3. Check Cumulus Dashboard PRs for Version Bump" title="Direct link to 3. Check Cumulus Dashboard PRs for Version Bump">​</a></h3><p>There may be unreleased changes in the Cumulus Dashboard <a href="https://github.com/nasa/cumulus-dashboard" target="_blank" rel="noopener noreferrer">project</a> that rely on this unreleased Cumulus Core version.</p><p>If there is exists a PR in the cumulus-dashboard repo with a name containing: &quot;Version Bump for Next Cumulus API Release&quot;:</p><ul><li>There will be a placeholder <code>change-me</code> value that should be replaced with the Cumulus Core to-be-released-version.</li><li>Mark that PR as ready to be reviewed.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-update-changelogmd">4. Update CHANGELOG.md<a href="#4-update-changelogmd" class="hash-link" aria-label="Direct link to 4. Update CHANGELOG.md" title="Direct link to 4. Update CHANGELOG.md">​</a></h3><p>Update the <code>CHANGELOG.md</code>. Put a header under the <code>Unreleased</code> section with the new version number and the date.</p><p>Add a link reference for the github &quot;compare&quot; view at the bottom of the <code>CHANGELOG.md</code>, following the existing pattern. This link reference should create a link in the CHANGELOG&#x27;s release header to changes in the corresponding release.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-update-data_model_changelogmd">5. Update DATA<!-- -->_<!-- -->MODEL<!-- -->_<!-- -->CHANGELOG.md<a href="#5-update-data_model_changelogmd" class="hash-link" aria-label="Direct link to 5-update-data_model_changelogmd" title="Direct link to 5-update-data_model_changelogmd">​</a></h3><p>Similar to #4, make sure the DATA<!-- -->_<!-- -->MODEL<!-- -->_<!-- -->CHANGELOG is updated if there are data model changes in the release, and the link reference at the end of the document is updated as appropriate.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-update-contributorsmd">6. Update CONTRIBUTORS.md<a href="#6-update-contributorsmd" class="hash-link" aria-label="Direct link to 6. Update CONTRIBUTORS.md" title="Direct link to 6. Update CONTRIBUTORS.md">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/update-contributors.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> CONTRIBUTORS.md</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Commit and push these changes, if any.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-update-cumulus-package-api-documentation">7. Update Cumulus package API documentation<a href="#7-update-cumulus-package-api-documentation" class="hash-link" aria-label="Direct link to 7. Update Cumulus package API documentation" title="Direct link to 7. Update Cumulus package API documentation">​</a></h3><p>Update auto-generated API documentation for any Cumulus packages that have it:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run docs-build-packages</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Commit and push these changes, if any.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-cut-new-version-of-cumulus-documentation">8. Cut new version of Cumulus Documentation<a href="#8-cut-new-version-of-cumulus-documentation" class="hash-link" aria-label="Direct link to 8. Cut new version of Cumulus Documentation" title="Direct link to 8. Cut new version of Cumulus Documentation">​</a></h3><p><strong>If this is a backport, do not create a new version of the documentation.</strong> For various reasons, we do not merge backports back to master, other than changelog notes. Documentation changes for backports will not be published to our documentation website.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> website</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run version </span><span class="token variable" style="color:rgb(191, 199, 213)">${release_version}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where <code>${release_version}</code> corresponds to the version tag <code>v1.2.3</code>, for example.</p><p>Commit and push these changes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-create-a-pull-request-against-the-minor-version-branch">9. Create a pull request against the minor version branch<a href="#9-create-a-pull-request-against-the-minor-version-branch" class="hash-link" aria-label="Direct link to 9. Create a pull request against the minor version branch" title="Direct link to 9. Create a pull request against the minor version branch">​</a></h3><ol><li><p>Push the release branch (e.g. <code>release-1.2.3</code>) to GitHub.</p></li><li><p>Create a PR against the minor version base branch (e.g. <code>release-1.2.x</code>).</p></li><li><p>Configure Bamboo to run automated tests against this PR by finding the branch plan for the release branch (<code>release-1.2.3</code>) and setting only these variables:</p><ul><li><code>GIT_PR</code>: <code>true</code></li><li><code>SKIP_AUDIT</code>: <code>true</code></li></ul><p><strong>IMPORTANT</strong>: Do NOT set the <code>PUBLISH_FLAG</code> variable to <code>true</code> for this branch plan. The actual publishing of the release will be handled by a separate, manually triggered branch plan.</p><p><img loading="lazy" alt="Screenshot of Bamboo CI interface showing the configuration of the GIT_PR branch variable to have a value of &amp;quot;true&amp;quot;" src="/cumulus/assets/images/configure-release-branch-test-9d167f40dca2c755094109a73591a8da.png" width="1304" height="524" class="img_ev3q"></p></li><li><p>Verify that the Bamboo build for the PR succeeds and then merge to the minor version base branch (<code>release-1.2.x</code>).</p><ul><li>It <strong>is safe</strong> to do a squash merge in this instance, but not required</li></ul></li><li><p>You may delete your release branch (<code>release-1.2.3</code>) after merging to the base branch.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-create-a-git-tag-for-the-release">10. Create a git tag for the release<a href="#10-create-a-git-tag-for-the-release" class="hash-link" aria-label="Direct link to 10. Create a git tag for the release" title="Direct link to 10. Create a git tag for the release">​</a></h3><p>Check out the minor version base branch (<code>release-1.2.x</code>) now that your changes are merged in and do a <code>git pull</code>.</p><p>Ensure you are on the latest commit.</p><p>Create and push a new git tag:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> tag -a vMAJOR.MINOR.PATCH -m </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Release MAJOR.MINOR.PATCH&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push origin vMAJOR.MINOR.PATCH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">e.g.:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> tag -a v9.1.0 -m </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Release 9.1.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push origin v9.1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-publishing-the-release">11. Publishing the release<a href="#11-publishing-the-release" class="hash-link" aria-label="Direct link to 11. Publishing the release" title="Direct link to 11. Publishing the release">​</a></h3><p>Publishing of new releases is handled by a custom Bamboo branch plan and is manually triggered.</p><p>The reasons for using a separate branch plan to handle releases instead of the branch plan for the minor version (e.g. <code>release-1.2.x</code>) are:</p><ul><li>The Bamboo build for the minor version release branch is triggered <strong>automatically</strong> on any commits to that branch, whereas we want to manually control when the release is published.</li><li>We want to verify that integration tests have passed on the Bamboo build for the minor version release branch <strong>before</strong> we manually trigger the release, so that we can be sure that our code is safe to release.</li></ul><p>If this is a new minor version branch, then you will need to create a new Bamboo branch plan for publishing the release following the instructions below:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-bamboo-branch-plan-for-the-release">Creating a Bamboo branch plan for the release<a href="#creating-a-bamboo-branch-plan-for-the-release" class="hash-link" aria-label="Direct link to Creating a Bamboo branch plan for the release" title="Direct link to Creating a Bamboo branch plan for the release">​</a></h4><ul><li><p>In the Cumulus Core project (<a href="https://ci.earthdata.nasa.gov/browse/CUM-CBA" target="_blank" rel="noopener noreferrer">https://ci.earthdata.nasa.gov/browse/CUM-CBA</a>), click <code>Actions -&gt; Configure Plan</code> in the top right.</p></li><li><p>Next to <code>Plan branch</code> click the rightmost button that displays <code>Create Plan Branch</code> upon hover.</p></li><li><p>Click <code>Create plan branch manually</code>.</p></li><li><p>Add the values in that list. Choose a display name that makes it <em>very</em> clear this is a deployment branch plan. <code>Release (minor version branch name)</code> seems to work well (e.g. <code>Release (1.2.x)</code>)).</p><ul><li><strong>Make sure</strong> you enter the correct branch name (e.g. <code>release-1.2.x</code>).</li></ul></li><li><p><strong>Important</strong> Deselect Enable Branch - if you do not do this, it will immediately fire off a build.</p></li><li><p><strong>Do Immediately</strong> On the <code>Branch Details</code> page, enable <code>Change trigger</code>.  Set the <code>Trigger type</code> to manual, this will prevent commits to the branch from triggering the build plan.
You should have been redirected to the <code>Branch Details</code> tab after creating the plan. If not, navigate to the branch from the list where you clicked <code>Create Plan Branch</code> in the previous step.</p></li><li><p>Go to the <code>Variables</code> tab. Ensure that you are on your branch plan and not the <code>master</code> plan: You should not see a large list of configured variables, but instead a dropdown allowing you to select variables to override, and the tab title will be <code>Branch Variables</code>. Then set the branch variables as follow:</p><ul><li><code>DEPLOYMENT</code>: <code>cumulus-from-npm-tf</code> (<strong>except in special cases such as incompatible backport branches</strong>)<ul><li>If this variable is not set, it will default to the deployment name for the last committer on the branch</li></ul></li><li><code>USE_CACHED_BOOTSTRAP</code>: <code>false</code></li><li><code>USE_TERRAFORM_ZIPS</code>: <code>true</code> (<strong>IMPORTANT</strong>: MUST be set in order to run integration tests against the <code>.zip</code> files published during the build so that we are actually testing our released files)</li><li><code>GIT_PR</code>: <code>true</code></li><li><code>SKIP_AUDIT</code>: <code>true</code></li><li><code>PUBLISH_FLAG</code>: <code>true</code></li></ul></li><li><p>Enable the branch from the <code>Branch Details</code> page.</p></li><li><p>Run the branch using the <code>Run</code> button in the top right.</p></li></ul><p>Bamboo will build and run lint and unit tests against that tagged release, publish the new packages to NPM, and then run the integration tests using those newly released packages.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-create-a-new-cumulus-release-on-github">12. Create a new Cumulus release on github<a href="#12-create-a-new-cumulus-release-on-github" class="hash-link" aria-label="Direct link to 12. Create a new Cumulus release on github" title="Direct link to 12. Create a new Cumulus release on github">​</a></h3><p>The CI release scripts will automatically create a GitHub release based on the release version tag, as well as upload artifacts to the Github release for the Terraform modules provided by Cumulus. The Terraform release artifacts include:</p><ul><li>A multi-module Terraform <code>.zip</code> artifact containing filtered copies of the <code>tf-modules</code>, <code>packages</code>, and <code>tasks</code> directories for use as Terraform module sources.</li><li>A S3 replicator module</li><li>A workflow module</li><li>A distribution API module</li><li>An ECS service module</li></ul><p>Just make sure to verify the appropriate .zip files are present on Github after the release process is complete.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-merge-base-branch-back-to-master">13. Merge base branch back to master<a href="#13-merge-base-branch-back-to-master" class="hash-link" aria-label="Direct link to 13. Merge base branch back to master" title="Direct link to 13. Merge base branch back to master">​</a></h3><p>Finally, you need to reproduce the version update changes back to master.</p><p>If this is the latest version, you can simply create a PR to merge the minor version base branch back to master.</p><p>Do not merge <code>master</code> back into the release branch since we want the release branch to <em>just</em> have the code from the release.  Instead, create a new branch off of the release branch and merge that to master. You can freely merge master into this branch and delete it when it is merged to master.</p><p>If this is a backport, you will need to create a PR that ports the changelog updates back to master. It is important in this changelog note to call it out as a backport. For example, fixes in backport version <code>1.14.5</code> may not be available in <code>1.15.0</code> because the fix was introduced in <code>1.15.3</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete-and-regenerate-the-tag">Delete and regenerate the tag<a href="#delete-and-regenerate-the-tag" class="hash-link" aria-label="Direct link to Delete and regenerate the tag" title="Direct link to Delete and regenerate the tag">​</a></h3><p>To delete a published tag to re-tag, follow these steps:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> tag -d vMAJOR.MINOR.PATCH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push -d origin vMAJOR.MINOR.PATCH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">e.g.:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> tag -d v9.1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push -d origin v9.1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-03-10T00:04:48.000Z">Mar 10, 2023</time></b> by <b>jennyhliu</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#versioning" class="table-of-contents__link toc-highlight">Versioning</a></li><li><a href="#pre-release-testing" class="table-of-contents__link toc-highlight">Pre-release testing</a></li><li><a href="#updating-cumulus-version-and-publishing-to-npm" class="table-of-contents__link toc-highlight">Updating Cumulus version and publishing to NPM</a><ul><li><a href="#1-create-a-branch-for-the-new-release" class="table-of-contents__link toc-highlight">1. Create a branch for the new release</a></li><li><a href="#2-update-the-cumulus-version-number" class="table-of-contents__link toc-highlight">2. Update the Cumulus version number</a></li><li><a href="#3-check-cumulus-dashboard-prs-for-version-bump" class="table-of-contents__link toc-highlight">3. Check Cumulus Dashboard PRs for Version Bump</a></li><li><a href="#4-update-changelogmd" class="table-of-contents__link toc-highlight">4. Update CHANGELOG.md</a></li><li><a href="#5-update-data_model_changelogmd" class="table-of-contents__link toc-highlight">5. Update DATA_MODEL_CHANGELOG.md</a></li><li><a href="#6-update-contributorsmd" class="table-of-contents__link toc-highlight">6. Update CONTRIBUTORS.md</a></li><li><a href="#7-update-cumulus-package-api-documentation" class="table-of-contents__link toc-highlight">7. Update Cumulus package API documentation</a></li><li><a href="#8-cut-new-version-of-cumulus-documentation" class="table-of-contents__link toc-highlight">8. Cut new version of Cumulus Documentation</a></li><li><a href="#9-create-a-pull-request-against-the-minor-version-branch" class="table-of-contents__link toc-highlight">9. Create a pull request against the minor version branch</a></li><li><a href="#10-create-a-git-tag-for-the-release" class="table-of-contents__link toc-highlight">10. Create a git tag for the release</a></li><li><a href="#11-publishing-the-release" class="table-of-contents__link toc-highlight">11. Publishing the release</a></li><li><a href="#12-create-a-new-cumulus-release-on-github" class="table-of-contents__link toc-highlight">12. Create a new Cumulus release on github</a></li><li><a href="#13-merge-base-branch-back-to-master" class="table-of-contents__link toc-highlight">13. Merge base branch back to master</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#delete-and-regenerate-the-tag" class="table-of-contents__link toc-highlight">Delete and regenerate the tag</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/cumulus/assets/js/runtime~main.6d34a879.js"></script>
<script src="/cumulus/assets/js/main.1257b213.js"></script>
</body>
</html>