<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v15.0.2 plugin-docs plugin-id-default docs-doc-id-workflows/workflows-readme" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Workflows | Cumulus Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nasa.github.io/cumulus/docs/v15.0.2/workflows/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v15.0.2"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v15.0.2"><meta data-rh="true" name="docsearch:version" content="v15.0.2"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v15.0.2"><meta data-rh="true" property="og:title" content="Workflows | Cumulus Documentation"><meta data-rh="true" name="description" content="Workflows are comprised of one or more AWS Lambda Functions and ECS Activities to discover, ingest, process, manage and archive data."><meta data-rh="true" property="og:description" content="Workflows are comprised of one or more AWS Lambda Functions and ECS Activities to discover, ingest, process, manage and archive data."><link data-rh="true" rel="icon" href="/cumulus/img/cumulus.ico"><link data-rh="true" rel="canonical" href="https://nasa.github.io/cumulus/docs/v15.0.2/workflows/"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v15.0.2/workflows/" hreflang="en"><link data-rh="true" rel="alternate" href="https://nasa.github.io/cumulus/docs/v15.0.2/workflows/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KBWSJQ0LBW-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Cumulus Documentation" href="/cumulus/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/cumulus/assets/css/styles.4f54c3bd.css">
<link rel="preload" href="/cumulus/assets/js/runtime~main.38b77263.js" as="script">
<link rel="preload" href="/cumulus/assets/js/main.8209f290.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cumulus/"><div class="navbar__logo"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA" height="32" width="32"><img src="/cumulus/img/ic_cumulus_logo_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU" height="32" width="32"></div><b class="navbar__title text--truncate">Cumulus Documentation</b></a><a href="https://nasa.github.io/cumulus-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://nasa.github.io/cumulus-distribution-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Distribution API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cumulus/docs/v15.0.2/">Developer Docs</a><a class="navbar__item navbar__link" href="/cumulus/docs/v15.0.2/data-cookbooks/about-cookbooks">Data Cookbooks</a><a class="navbar__item navbar__link" href="/cumulus/docs/v15.0.2/operator-docs/about-operator-docs">Operator Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/cumulus/docs/v15.0.2/">v15.0.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/cumulus/docs/next/workflows/">Next</a></li><li><a class="dropdown__link" href="/cumulus/docs/workflows/">v20.2.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v20.1.2/workflows/">v20.1.2</a></li><li><a class="dropdown__link" href="/cumulus/docs/v20.1.1/workflows/">v20.1.1</a></li><li><a class="dropdown__link" href="/cumulus/docs/v20.0.0/workflows/">v20.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v19.1.0/workflows/">v19.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v19.0.0/workflows/">v19.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.5.0/workflows/">v18.5.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.4.0/workflows/">v18.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.3.4/workflows/">v18.3.4</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.2.0/workflows/">v18.2.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.1.0/workflows/">v18.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v18.0.0/workflows/">v18.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v17.0.0/workflows/">v17.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.1.3/workflows/">v16.1.3</a></li><li><a class="dropdown__link" href="/cumulus/docs/v16.0.0/workflows/">v16.0.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cumulus/docs/v15.0.2/workflows/">v15.0.2</a></li><li><a class="dropdown__link" href="/cumulus/docs/v14.1.0/workflows/">v14.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.4.0/workflows/">v13.4.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v13.0.0/workflows/">v13.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v12.0.0/workflows/">v12.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.1.0/workflows/">v11.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v11.0.0/workflows/">v11.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.1.0/workflows/">v10.1.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v10.0.0/workflows/">v10.0.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.9.0/workflows/">v9.9.0</a></li><li><a class="dropdown__link" href="/cumulus/docs/v9.0.0/workflows/">v9.0.0</a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/cumulus/versions">All versions</a></li></ul></div><a href="https://github.com/nasa/cumulus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="Cumulus Core GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/architecture">About Cumulus</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cumulus/docs/v15.0.2/workflows/">Overviews</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cumulus/docs/v15.0.2/workflows/">Workflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v15.0.2/workflows/protocol">Workflow Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v15.0.2/workflows/input_output">Workflow Inputs &amp; Outputs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v15.0.2/workflows/cumulus-task-message-flow">Cumulus Tasks: Message Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cumulus/docs/v15.0.2/workflows/workflow-triggers">Workflow Triggers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/deployment/">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/configuration/data-management-types">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/workflows/developing-a-cumulus-workflow">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/tasks">Workflow Tasks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/features/backup_and_restore">Features</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/troubleshooting/">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/adding-a-task">Cumulus Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/integrator-guide/about-int-guide">Integrator Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/upgrade-notes/migrate_tea_standalone">Upgrade Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cumulus/docs/v15.0.2/external-contributions/">External Contributions</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cumulus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Overviews</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Workflows</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v15.0.2</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Workflows</h1></header><p>Workflows are comprised of one or more AWS Lambda Functions and ECS Activities to discover, ingest, process, manage and archive data.</p><p>Provider data ingest and GIBS have a set of common needs in getting data from a source system and into the cloud where they can be distributed to end users. These common needs are:</p><ul><li><strong>Data Discovery</strong> - Crawling, polling, or detecting changes from a variety of sources.</li><li><strong>Data Transformation</strong> - Taking data files in their original format and extracting and transforming them into another desired format such as visible browse images.</li><li><strong>Archival</strong> - Storage of the files in a location that&#x27;s accessible to end users.</li></ul><p>The high level view of the architecture and many of the individual steps are the same but the details of ingesting each type of collection differs. Different collection types and different providers have different needs. The individual <em>boxes</em> of a workflow are not only different. The branching, error handling, and multiplicity of the <em>arrows</em> connecting the boxes are also different. Some need visible images rendered from component data files from multiple collections. Some need to contact the CMR with updated metadata. Some will have different retry strategies to handle availability issues with source data systems.</p><p>AWS and other cloud vendors provide an ideal solution for parts of these problems but there needs to be a higher level solution to allow the composition of AWS components into a full featured solution. The Ingest Workflow Architecture is designed to meet the needs for Earth Science data ingest and transformation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="goals">Goals<a href="#goals" class="hash-link" aria-label="Direct link to Goals" title="Direct link to Goals">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="flexibility-and-composability">Flexibility and Composability<a href="#flexibility-and-composability" class="hash-link" aria-label="Direct link to Flexibility and Composability" title="Direct link to Flexibility and Composability">​</a></h3><p>The steps to ingest and process data is different for each collection within a provider. Ingest should be as flexible as possible in the rearranging of steps and configuration.</p><p>We want to use lego-like individual steps that can be composed by an operator.</p><p>Individual steps should ...</p><ul><li>Be as ignorant as possible of the overall flow. They should not be aware of previous steps.</li><li>Be runnable on their own.</li><li>Define their input and output in simple data structures.</li><li>Be domain agnostic.</li><li>Not make assumptions of specifics of what goes into a granule for example.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scalable">Scalable<a href="#scalable" class="hash-link" aria-label="Direct link to Scalable" title="Direct link to Scalable">​</a></h3><p>The ingest architecture needs to be scalable both to handle ingesting hundreds of millions of granules and interpret dozens of different workflows.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-provenance">Data Provenance<a href="#data-provenance" class="hash-link" aria-label="Direct link to Data Provenance" title="Direct link to Data Provenance">​</a></h3><ul><li>We should have traceability for how data was produced and where it comes from.</li><li>Use immutable representations of data. Data once received is not overwritten. Data can be removed for cleanup.</li><li>All software is versioned. We can trace transformation of data by tracking the immutable source data and the versioned software applied to it.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="operator-visibility-and-control">Operator Visibility and Control<a href="#operator-visibility-and-control" class="hash-link" aria-label="Direct link to Operator Visibility and Control" title="Direct link to Operator Visibility and Control">​</a></h3><ul><li>Operators should be able to see and understand everything that is happening in the system.</li><li>It should be obvious why things are happening and straightforward to diagnose problems.</li><li>We generally assume that the operators know best in terms of the limits on a providers infrastructure, how often things need to be done, and details of a collection. The architecture should defer to their decisions and knowledge while providing safety nets to prevent problems.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-reconfigurable-workflow-architecture">A Reconfigurable Workflow Architecture<a href="#a-reconfigurable-workflow-architecture" class="hash-link" aria-label="Direct link to A Reconfigurable Workflow Architecture" title="Direct link to A Reconfigurable Workflow Architecture">​</a></h2><p>The Ingest Workflow Architecture is defined by two entity types, <a href="#workflows">Workflows</a> and <a href="#tasks">Tasks</a>. A Workflow is a set of composed Tasks to complete an objective such as ingesting a granule. Tasks are the individual steps of a Workflow that perform one job. The workflow is responsible for executing the right task based on the current state and response from the last task executed. Tasks are completely decoupled in that they don&#x27;t call each other or even need to know about the presence of other tasks.</p><p>Workflows and tasks are configured as Terraform resources, which are triggered via configured <code>rules</code> within Cumulus.</p><p><img loading="lazy" alt="Diagram showing the Step Function execution path through workflow tasks for a collection ingest" src="/cumulus/assets/images/ingest_diagram-4512e9fefbe5d1cfda2d4aaf76c7b9ff.png" width="1120" height="820" class="img_ev3q"></p><p>See the <a href="#example-gibs-ingest-architecture">Example GIBS Ingest Architecture</a> showing how workflows and tasks are used to define the GIBS Ingest Architecture.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="workflows">Workflows<a href="#workflows" class="hash-link" aria-label="Direct link to Workflows" title="Direct link to Workflows">​</a></h3><p>A workflow is a provider-configured set of steps that describe the process to ingest data. Workflows are defined using <a href="https://aws.amazon.com/documentation/step-functions/" target="_blank" rel="noopener noreferrer">AWS Step Functions</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="benefits-of-aws-step-functions">Benefits of AWS Step Functions<a href="#benefits-of-aws-step-functions" class="hash-link" aria-label="Direct link to Benefits of AWS Step Functions" title="Direct link to Benefits of AWS Step Functions">​</a></h4><p>AWS Step functions are described in detail in the AWS documentation but they provide several benefits which are applicable to AWS.</p><ul><li>Prebuilt solution</li><li>Operations Visibility<ul><li>Visual diagram</li><li>Every execution is recorded with both inputs and output for every step.</li></ul></li><li>Composability<ul><li>Allow composing AWS Lambdas and code running in other steps. Code can be run in EC2 to interface with it or even on premise if desired.</li><li>Step functions allow specifying when steps run in parallel or choices between steps based on data from the previous step.</li></ul></li><li>Flexibility<ul><li>Step functions are designed to be easy to build new applications and reconfigure. We&#x27;re exposing that flexibility directly to the provider.</li></ul></li><li>Reliability and Error Handling<ul><li>Step functions allow configuration of retries and adding handling of error conditions.</li></ul></li><li>Described via data<ul><li>This makes it easy to save the step function in configuration management solutions.</li><li>We can build simple interfaces on top of the flexibility provided.</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="workflow-scheduler">Workflow Scheduler<a href="#workflow-scheduler" class="hash-link" aria-label="Direct link to Workflow Scheduler" title="Direct link to Workflow Scheduler">​</a></h4><p>The scheduler is responsible for initiating a step function and passing in the relevant data for a collection. This is currently configured as an interval for each collection. The scheduler service creates the initial event by combining the collection configuration with the AWS execution context defined via the <code>cumulus</code> terraform module.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tasks">Tasks<a href="#tasks" class="hash-link" aria-label="Direct link to Tasks" title="Direct link to Tasks">​</a></h3><p>A workflow is composed of tasks. Each task is responsible for performing a discrete step of the ingest process. These can be activities like:</p><ul><li>Crawling a provider website for new data.</li><li>Uploading data from a provider to S3.</li><li>Executing a process to transform data.</li></ul><p>AWS Step Functions permit <a href="http://docs.aws.amazon.com/step-functions/latest/dg/concepts-tasks.html#concepts-tasks" target="_blank" rel="noopener noreferrer">tasks</a> to be code running anywhere, even on premise. We expect most tasks will be written as Lambda functions in order to take advantage of the easy deployment, scalability, and cost benefits provided by AWS Lambda.</p><ul><li><strong>Leverages Existing Work</strong><ul><li>The design leverages the existing work of Amazon by defining workflows using the <a href="http://docs.aws.amazon.com/step-functions/latest/dg/amazon-states-language.html#amazon-states-language" target="_blank" rel="noopener noreferrer">AWS Step Function State Language</a>. This is the language that was created for describing the state machines used in AWS Step Functions.</li></ul></li><li><strong>Open for Extension</strong><ul><li>Both <code>meta</code> and <code>task_config</code> which are used for configuring at the collection and task levels do not dictate the fields and structure of the configuration. Additional task specific JSON schemas can be used for extending the validation of individual steps.</li></ul></li><li><strong>Data-centric Configuration</strong><ul><li>The use of a single JSON configuration file allows this to be added to a workflow. We build additional support on top of the configuration file for simpler domain specific configuration or interactive GUIs.</li></ul></li></ul><p>For more details on Task Messages and Configuration, visit <a href="/cumulus/docs/v15.0.2/workflows/cumulus-task-message-flow">Cumulus configuration and message protocol documentation</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ingest-deploy">Ingest Deploy<a href="#ingest-deploy" class="hash-link" aria-label="Direct link to Ingest Deploy" title="Direct link to Ingest Deploy">​</a></h3><p>To view deployment documentation, please see the <a href="/cumulus/docs/v15.0.2/deployment/">Cumulus deployment documentation</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tradeoffs-and-benefits">Tradeoffs, and Benefits<a href="#tradeoffs-and-benefits" class="hash-link" aria-label="Direct link to Tradeoffs, and Benefits" title="Direct link to Tradeoffs, and Benefits">​</a></h2><p>This section documents various tradeoffs and benefits of the Ingest Workflow Architecture.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tradeoffs">Tradeoffs<a href="#tradeoffs" class="hash-link" aria-label="Direct link to Tradeoffs" title="Direct link to Tradeoffs">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="workflow-execution-is-handled-completely-by-aws">Workflow execution is handled completely by AWS<a href="#workflow-execution-is-handled-completely-by-aws" class="hash-link" aria-label="Direct link to Workflow execution is handled completely by AWS" title="Direct link to Workflow execution is handled completely by AWS">​</a></h4><p>This means we can&#x27;t add our own code into the orchestration of the workflow. We can&#x27;t add new features not supported by Step Functions. We can&#x27;t do things like enforce that the responses from tasks always conform to a schema or extract the configuration for a task ahead of it&#x27;s execution.</p><p>If we implemented our own orchestration we&#x27;d be able to add all of these. We save significant amounts of development effort and gain all the features of Step Functions for this trade off. One workaround is by providing a library of common task capabilities. These would optionally be available to tasks that can be implemented with Node.js and are able to include the library.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="workflow-configuration-is-specified-in-aws-step-function-states-language">Workflow Configuration is specified in AWS Step Function States Language<a href="#workflow-configuration-is-specified-in-aws-step-function-states-language" class="hash-link" aria-label="Direct link to Workflow Configuration is specified in AWS Step Function States Language" title="Direct link to Workflow Configuration is specified in AWS Step Function States Language">​</a></h4><p>The current design combines the states language defined by AWS with Ingest specific configuration. This means our representation has a tight coupling with their standard. If they make backwards incompatible changes in the future we will have to deal with existing projects written against that.</p><p>We avoid having to develop our own standard and code to process it. The design can support new features in AWS Step Functions without needing to update the Ingest library code changes. It is unlikely they will make a backwards incompatible change at this point. One mitigation for this is writing data transformations to a new format if that were to happen.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="collection-configuration-flexibility-vs-complexity">Collection Configuration Flexibility vs Complexity<a href="#collection-configuration-flexibility-vs-complexity" class="hash-link" aria-label="Direct link to Collection Configuration Flexibility vs Complexity" title="Direct link to Collection Configuration Flexibility vs Complexity">​</a></h4><p>The Collections Configuration File is very flexible but requires more knowledge of AWS step functions to configure. A person modifying this file directly would need to comfortable editing a JSON file and configuring AWS Step Functions state transitions which address AWS resources.</p><p>The configuration file itself is not necessarily meant to be edited by a human directly. Since we are developing a reconfigurable, composable architecture that specified entirely in <em>data</em> additional tools can be developed on top of it. The existing <code>recipes.json</code> files can be mapped to this format. Operational Tools like a GUI can be built that provide a usable interface for customizing workflows but it will take time to develop these tools.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="benefits">Benefits<a href="#benefits" class="hash-link" aria-label="Direct link to Benefits" title="Direct link to Benefits">​</a></h3><p>This section describes benefits of the Ingest Workflow Architecture.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="simplicity">Simplicity<a href="#simplicity" class="hash-link" aria-label="Direct link to Simplicity" title="Direct link to Simplicity">​</a></h4><p>The concepts of Workflows and Tasks are simple ones that should make sense to providers. Additionally, the implementation will only consist of a few components because the design leverages existing services and capabilities of AWS. The Ingest implementation will only consist of some reusable task code to make task implementation easier, Ingest deployment, and the Workflow Scheduler.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="composability">Composability<a href="#composability" class="hash-link" aria-label="Direct link to Composability" title="Direct link to Composability">​</a></h4><p>The design aims to satisfy the needs for ingest integrating different workflows for providers. It&#x27;s flexible in terms of the ability to arrange tasks to meet the needs of a collection. Providers have developed and incorporated open source tools over the years. All of these are easily integrable into the workflows as tasks.</p><p>There is low coupling between task steps. Failures of one component don&#x27;t bring the whole system down. Individual tasks can be deployed separately.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="scalability">Scalability<a href="#scalability" class="hash-link" aria-label="Direct link to Scalability" title="Direct link to Scalability">​</a></h4><p>AWS Step Functions scale up as needed and aren&#x27;t limited by a set of number of servers. They also easily allow you to leverage the inherent scalability of serverless functions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-and-auditing">Monitoring and Auditing<a href="#monitoring-and-auditing" class="hash-link" aria-label="Direct link to Monitoring and Auditing" title="Direct link to Monitoring and Auditing">​</a></h4><ul><li>Every execution is captured.</li><li>Every task run has captured input and outputs.</li><li>CloudWatch Metrics can be <a href="https://docs.aws.amazon.com/step-functions/latest/dg/procedure-cw-metrics.html" target="_blank" rel="noopener noreferrer">used for monitoring</a> many of the events with the StepFunctions. It can also generate alarms for the whole process.</li><li>Visual report of the entire configuration.<ul><li>Errors and success states are highlighted visually in the flow.</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-provenance-1">Data Provenance<a href="#data-provenance-1" class="hash-link" aria-label="Direct link to Data Provenance" title="Direct link to Data Provenance">​</a></h4><ul><li>Monitoring and auditing ensures we know the data that was given to a task.</li><li>Workflows are versioned and the state machines stored in AWS Step Functions are immutable. Once created they cannot change.</li><li>Versioning of data in S3 or using immutable records in S3 will mean we always know what data was created as the result of a step or fed into a step.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-gibs-ingest-architecture">Example GIBS Ingest Architecture<a href="#example-gibs-ingest-architecture" class="hash-link" aria-label="Direct link to Example GIBS Ingest Architecture" title="Direct link to Example GIBS Ingest Architecture">​</a></h3><p>This shows the GIBS Ingest Architecture as an example of the use of the Ingest Workflow Architecture.</p><ul><li>The GIBS Ingest Architecture consists of two workflows per collection type. There is one for discovery and one for ingest. The final stage of discovery triggers multiple ingest workflows for each MRF granule that needs to be generated.</li><li>It demonstrates both lambdas as tasks and a container used for MRF generation.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gibs-ingest-workflows">GIBS Ingest Workflows<a href="#gibs-ingest-workflows" class="hash-link" aria-label="Direct link to GIBS Ingest Workflows" title="Direct link to GIBS Ingest Workflows">​</a></h4><p><img loading="lazy" alt="Diagram showing the AWS Step Function execution path for a GIBS ingest workflow" src="/cumulus/assets/images/ingest_diagram_gibs-8785b6bc1f7e482c6acfb780a1ba0b16.png" width="1140" height="908" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gibs-ingest-granules-workflow">GIBS Ingest Granules Workflow<a href="#gibs-ingest-granules-workflow" class="hash-link" aria-label="Direct link to GIBS Ingest Granules Workflow" title="Direct link to GIBS Ingest Granules Workflow">​</a></h4><p>This shows a visualization of an execution of the ingets granules workflow in step functions. The steps highlighted in green are the ones that executed and completed successfully.</p><p><img loading="lazy" alt="Diagram showing the AWS Step Function execution path for a GIBS ingest granules workflow" src="/cumulus/assets/images/gibs_ingest_granules_workflow-7e9c145055a97be24d5d73daad1b1a33.png" width="518" height="568" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-28T22:41:25.000Z">Apr 28, 2023</time></b> by <b>Naga Nages</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cumulus/docs/v15.0.2/team"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cumulus Team</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cumulus/docs/v15.0.2/workflows/protocol"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Workflow Protocol</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goals" class="table-of-contents__link toc-highlight">Goals</a><ul><li><a href="#flexibility-and-composability" class="table-of-contents__link toc-highlight">Flexibility and Composability</a></li><li><a href="#scalable" class="table-of-contents__link toc-highlight">Scalable</a></li><li><a href="#data-provenance" class="table-of-contents__link toc-highlight">Data Provenance</a></li><li><a href="#operator-visibility-and-control" class="table-of-contents__link toc-highlight">Operator Visibility and Control</a></li></ul></li><li><a href="#a-reconfigurable-workflow-architecture" class="table-of-contents__link toc-highlight">A Reconfigurable Workflow Architecture</a><ul><li><a href="#workflows" class="table-of-contents__link toc-highlight">Workflows</a></li><li><a href="#tasks" class="table-of-contents__link toc-highlight">Tasks</a></li><li><a href="#ingest-deploy" class="table-of-contents__link toc-highlight">Ingest Deploy</a></li></ul></li><li><a href="#tradeoffs-and-benefits" class="table-of-contents__link toc-highlight">Tradeoffs, and Benefits</a><ul><li><a href="#tradeoffs" class="table-of-contents__link toc-highlight">Tradeoffs</a></li><li><a href="#benefits" class="table-of-contents__link toc-highlight">Benefits</a></li></ul></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#example-gibs-ingest-architecture" class="table-of-contents__link toc-highlight">Example GIBS Ingest Architecture</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/cumulus/assets/js/runtime~main.38b77263.js"></script>
<script src="/cumulus/assets/js/main.8209f290.js"></script>
</body>
</html>