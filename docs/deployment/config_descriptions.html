<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Configuration Descriptions · Cumulus Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Cumulus Configuration"/><meta name="docsearch:version" content="v1.14.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Configuration Descriptions · Cumulus Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://nasa.github.io/cumulus/"/><meta property="og:description" content="# Cumulus Configuration"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/cumulus/undefined"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/cumulus/js/scrollSpy.js"></script><link rel="stylesheet" href="/cumulus/css/main.css"/><script src="/cumulus/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/cumulus/"><h2 class="headerTitle">Cumulus Documentation</h2></a><a href="/cumulus/versions"><h3>v1.14.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://nasa.github.io/cumulus-api" target="_self">API Docs</a></li><li class="siteNavGroupActive"><a href="/cumulus/docs/cumulus-docs-readme" target="_self">Developer Docs</a></li><li class=""><a href="/cumulus/docs/data-cookbooks/about-cookbooks" target="_self">Data-Cookbooks</a></li><li class=""><a href="/cumulus/docs/operator-docs/about-operator-docs" target="_self">Operator Docs</a></li><li class="siteNavGroupActive"><a href="/cumulus/docs/team" target="_self">Team</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Deployment</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">About Cumulus</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/cumulus-docs-readme">Cumulus Description</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/architecture">Cumulus Architecture</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/interfaces">Cumulus Interfaces</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/glossary">Cumulus Glossary</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/team">Team</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">What are Cumulus Workflows?</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/workflows-readme">Workflows</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/protocol">Workflow Protocol</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/input_output">Workflows Input &amp; Output</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/cumulus-task-message-flow">Cumulus Tasks: Message Flow</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/developing-workflow-tasks">Developing Workflow Tasks</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/lambda">Develop Lambda Functions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/docker">Dockerizing Data Processing</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/workflow-configuration-how-to">Workflow Configuration How To&#x27;s</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflows/workflow-triggers">Workflow Triggers</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tasks</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/tasks">Cumulus Tasks</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflow_tasks/discover_granules">Discover Granules</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflow_tasks/files_to_granules">Files To Granules</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflow_tasks/move_granules">Move Granules</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/workflow_tasks/parse_pdr">Parse PDR</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Deployment</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/deployment-readme">How to Deploy Cumulus</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/components">Cumulus Components</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/create_bucket">Creating an S3 Bucket</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/server_access_logging">S3 Server Access Logging</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/iam_roles">Cumulus IAM Roles</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/obtain_cumulus_packages">Obtaining Cumulus Packages</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/cumulus/docs/deployment/config_descriptions">Configuration Descriptions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/cmr_launchpad_authentication">CMR Launchpad Authentication</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/cumulus_api_launchpad_authentication">Cumulus API Launchpad Authentication</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/troubleshoot_deployment">Troubleshooting Cumulus Deployment</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/distribution_component">Cumulus Distribution Terraform Module</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/deployment/thin_egress_app">Thin Egress App</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Deployment Options</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/additional-deployment-options/delete-api-gateway-stages">Delete API Gateway Stages</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/additional-deployment-options/enable-gateway-logging-permissions">API Gateway Logging Permissions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/additional-deployment-options/enable-api-logs">Enable API Gateway Logging</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/additional-deployment-options/configure-cloudwatch-logs-delivery">API Gateway Logs Delivery</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/additional-deployment-options/additional-lambda-logging">Lambda Log Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/additional-deployment-options/share-s3-access-logs">Share S3 Access Logs</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Additional Features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/features/dead_letter_queues">Dead Letter Queues</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/features/ems_reporting">EMS Reporting</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/features/execution_payload_retention">Execution Payload Retention</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/features/lambda_versioning">Lambda Versioning</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/features/ancillary_metadata">Ancillary Metadata Export</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/features/distribution-metrics">Cumulus Distribution Metrics</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Upgrading Cumulus</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/upgrade/upgrade-readme">Upgrading Cumulus</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/system-documentation/system-documentation">Troubleshooting Cumulus</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Cumulus Development</h3><ul class=""><li class="navListItem"><a class="navItem" href="/cumulus/docs/adding-a-task">Contributing a Task</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/docs-how-to">Cumulus Documentation: How To&#x27;s</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="cumulus-configuration"></a><a href="#cumulus-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cumulus Configuration</h1>
<h2><a class="anchor" aria-hidden="true" id="overview"></a><a href="#overview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2>
<p>The tables below provide overviews of the minimally required <code>config.yml</code> variables and all variables, respectively.
Note that entries delimited as &lt;name&gt; are intended to be read as objects where <code>name</code> is the key, not the value, e.g.:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Config for 'dynamos.\&lt;name\&gt;.read' where `name = UsersTable`</span>
<span class="hljs-attr">dynamos:</span>
<span class="hljs-attr">  UsersTable:</span>
<span class="hljs-attr">    read:</span> <span class="hljs-number">5</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="configyml-requirements"></a><a href="#configyml-requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>config.yml Requirements</h3>
<p>This table describes the fields that must be present in <code>config.yml</code> to successfully deploy our cloudformation template, and under what conditions. For descriptions, see the complete table below or each item's entry in the invidivual listings on the rest of this page.</p>
<table>
<thead>
<tr><th>field</th><th>condition</th></tr>
</thead>
<tbody>
<tr><td>prefix</td><td>always required</td></tr>
<tr><td>prefixNoDash</td><td>always required for <code>app</code> stack</td></tr>
<tr><td>buckets</td><td>at least an <code>internal</code> bucket always required</td></tr>
<tr><td>vpc</td><td>must be present as either <code>vpc: null</code> for no VPC or as <code>.env</code> values, see the <a href="config_descriptions#vpc">vpc section</a></td></tr>
<tr><td>users</td><td>at least one user required</td></tr>
<tr><td>ecs.amiid</td><td>required on non-NGAP deployments (latest AWS ECS-Optimized AMI recommended)</td></tr>
<tr><td>ecs.instanceType</td><td>always required</td></tr>
<tr><td>cmr.username</td><td>always required</td></tr>
<tr><td>cmr.password</td><td>always required</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="configyml-explained"></a><a href="#configyml-explained" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>config.yml Explained</h3>
<table>
<thead>
<tr><th>field</th><th>default</th><th>description</th></tr>
</thead>
<tbody>
<tr><td>prefix</td><td>(required)</td><td>the name used as a prefix in all aws resources</td></tr>
<tr><td>prefixNoDash</td><td>(required)</td><td>prefix with no dash</td></tr>
<tr><td>users</td><td></td><td>List of URS usernames permitted to access the Cumulus dashboard/API</td></tr>
<tr><td>urs_url</td><td><code>https://uat.urs.earthdata.nasa.gov/</code></td><td>URS url used for OAuth</td></tr>
<tr><td>useNgapPermissionBoundary</td><td>false</td><td>Required to be <code>true</code> when deploying to the NGAP platform</td></tr>
<tr><td>useWorkflowLambdaVersions</td><td>true</td><td>Version deployed lambdas when they are updated.</td></tr>
<tr><td>cmr.oauthProvider</td><td>earthdata</td><td>the authentication provider used for CMR actions, possible values are 'earthdata', 'launchpad'</td></tr>
<tr><td>cmr.username</td><td>(required)</td><td>the username used for posting metadata to CMR</td></tr>
<tr><td>cmr.provider</td><td>CUMULUS</td><td>the provider used for posting metadata to CMR</td></tr>
<tr><td>cmr.clientId</td><td>CUMULUS</td><td>the clientId used to authenticate with the CMR</td></tr>
<tr><td>cmr.password</td><td>(required)</td><td>the password used to authenticate with the CMR</td></tr>
<tr><td>cmr.cmrEnvironment</td><td>UAT</td><td>the cmr environment</td></tr>
<tr><td>cmr.cmrLimit</td><td>50</td><td>the limit for CMR records returned from a search</td></tr>
<tr><td>cmr.cmrPageSize</td><td>100</td><td>the CMR page size</td></tr>
<tr><td>buckets</td><td>(required)</td><td>Configuration of buckets with key, bucket name, and type (i.e. internal, public, private, protected)</td></tr>
<tr><td>system_bucket</td><td><code>buckets.internal.name</code></td><td>the bucket used for storing deployment artifacts</td></tr>
<tr><td>shared_data_bucket</td><td>cumulus-data-shared</td><td>bucket containing shared data artifacts</td></tr>
<tr><td>ems.provider</td><td>CUMULUS</td><td>the provider used for sending reports to EMS</td></tr>
<tr><td>ems.submitReport</td><td>false</td><td>indicates if the reports will be sent to EMS</td></tr>
<tr><td>ems.host</td><td>(required if ems.submitReport is true)</td><td>EMS host</td></tr>
<tr><td>ems.port</td><td>22</td><td>EMS host port</td></tr>
<tr><td>ems.path</td><td>/</td><td>EMS host directory path for reports</td></tr>
<tr><td>ems.username</td><td>(required if ems.submitReport is true)</td><td>the username used for sending reports to EMS</td></tr>
<tr><td>ems.privateKey</td><td>ems-private.pem</td><td>the private key file used for sending reports to EMS</td></tr>
<tr><td>ems.dataSource</td><td>UAT</td><td>the data source of EMS reports</td></tr>
<tr><td>ems.retentionInDays</td><td>30</td><td>the retention in days for reports and s3 server access logs</td></tr>
<tr><td>vpc.vpcId</td><td>(required if ecs is used)</td><td>the vpcId used with the deployment</td></tr>
<tr><td>vpc.subnets</td><td>(required)</td><td>the subnets used</td></tr>
<tr><td>vpc.securityGroup</td><td>(required)</td><td>security group ID to be used by Cumulus resources, must allow inbound HTTP(S) access (Port 443), optionally may allow SSH to access ECS instances.</td></tr>
<tr><td>ecs.amiid</td><td>ami-9eb4b1e5</td><td>amiid of an optimized ecs instance (different for each region)</td></tr>
<tr><td>ecs.instanceType</td><td>(required)</td><td>the instance type of the ec2 machine used for running ecs tasks</td></tr>
<tr><td>ecs.volumeSize</td><td>50</td><td>the storage on ec2 instance running the ecs tasks</td></tr>
<tr><td>ecs.availabilityZone</td><td>us-east-1a</td><td>the availability zone used for launching ec2 machines. If using <code>vpc</code>, must match AZ of <code>vpc.subnets</code></td></tr>
<tr><td>ecs.minInstances</td><td>1</td><td>min number of ec2 instances to launch in an autoscaling group</td></tr>
<tr><td>ecs.desiredInstances</td><td>1</td><td>desired number of ec2 instances needed in an autoscaling group</td></tr>
<tr><td>ecs.maxInstances</td><td>2</td><td>max number of ec2 instances to launch in an autoscaling group</td></tr>
<tr><td>ecs.publicIp</td><td>false</td><td>assign public IP(s) to ECS instance(s)</td></tr>
<tr><td>ecs.restartTasksOnDeploy</td><td>false</td><td>whether kes should restart ECS tasks on deploy</td></tr>
<tr><td>ecs.docker.username</td><td>(empty string)</td><td>Username to pull images from registry</td></tr>
<tr><td>ecs.docker.registry</td><td>dockerhub</td><td>container registry to fetch from (currently supports <code>dockerhub</code> and <code>ecr</code>)</td></tr>
<tr><td>ecs.services</td><td></td><td>ECS service configurations (see <code>@cumulus/deployment/app/config.yml</code> for examples of core usage)</td></tr>
<tr><td>ecs.tasks</td><td></td><td>ECS task configurations (see <code>@cumulus/deployment/app/config.yml</code> for examples of core usage)</td></tr>
<tr><td>activities</td><td></td><td>list of activities</td></tr>
<tr><td>es.name</td><td>es5</td><td>name of the elasticsearch cluster</td></tr>
<tr><td>es.elasticSearchMapping</td><td>4</td><td>version number of the elasticsearch mapping used</td></tr>
<tr><td>es.version</td><td>5.3</td><td>elasticsearch software version</td></tr>
<tr><td>es.instanceCount</td><td>1</td><td>number of elasticsearch nodes</td></tr>
<tr><td>es.instanceType</td><td>t2.small.elasticsearch</td><td>size of the ec2 instance used for the elasticsearch</td></tr>
<tr><td>es.volumeSize</td><td>35</td><td>the storage used in each elasticsearch node</td></tr>
<tr><td>launchpad.api</td><td></td><td>launchpad API endpoint</td></tr>
<tr><td>launchpad.certificate</td><td>launchpad.pfx</td><td>the Launchpad PKI certificate pfx file</td></tr>
<tr><td>launchpad.passphrase</td><td></td><td>the passphrase of the Launchpad PIK certificate</td></tr>
<tr><td>oauth.provider</td><td>earthdata</td><td>the authentication provider used for Cumulus API, possible values are 'earthdata', 'google', 'launchpad'</td></tr>
<tr><td>oauth.userGroup</td><td>N/A</td><td>the cumulus user group that the user should belong to in order to be authenticated</td></tr>
<tr><td>sns.&lt;name&gt;</td><td></td><td>name of the sns topic</td></tr>
<tr><td>sns.&lt;name&gt;.subscriptions.&lt;subscription_name&gt;.endpoint</td><td></td><td>lambda function triggered for each message in the topic (see <code>@cumulus/deployment/app/config.yml</code> for examples of core usage)</td></tr>
<tr><td>apis.&lt;name&gt;</td><td></td><td>name of the apigateway application</td></tr>
<tr><td>apiStage</td><td>dev</td><td>stage name used for each api gateway deployment stage</td></tr>
<tr><td>api_lambda_memory</td><td>756</td><td>API Lambda function allocated memory in MB</td></tr>
<tr><td>api_backend_url</td><td></td><td>(Override) Alternate API backend url</td></tr>
<tr><td>api_distribution_url</td><td></td><td>(Override) Alternate API url used for file distribution</td></tr>
<tr><td>dynamos.&lt;name&gt;</td><td></td><td>name of the dynamoDB table</td></tr>
<tr><td>dynamos.&lt;name&gt;.read</td><td>5</td><td>number of reads per second</td></tr>
<tr><td>dynamos.&lt;name&gt;.write</td><td>1</td><td>number of writes per second</td></tr>
<tr><td>dynamos.&lt;name&gt;.attributes</td><td></td><td>list of attributes</td></tr>
<tr><td>backgroundQueueName</td><td><code>backgroundProcessing</code></td><td>Name of the queue to use for jobs that should be subject to execution limits. By default, this queue is used for scheduling granule reingest executions. See <code>@cumulus/deployment/app/config.yml</code> for configuration of <code>backgroundProcessing</code> queue.</td></tr>
<tr><td>sqs.&lt;name&gt;</td><td></td><td>name of the queue</td></tr>
<tr><td>sqs.&lt;name&gt;.visibilityTimeout</td><td>20</td><td># of seconds the message returns to the queue after it is read by a consumer</td></tr>
<tr><td>sqs.&lt;name&gt;.retry</td><td>30</td><td>number of time the message is returned to the queue before being discarded</td></tr>
<tr><td>sqs.&lt;name&gt;.maxExecutions</td><td></td><td>the maximum number of executions started from this queue that can run concurrently</td></tr>
<tr><td>sqs.&lt;name&gt;.consumer</td><td></td><td>list of lambda function queue consumer objects (see <code>@cumulus/deployment/app/config.yml</code> for examples of core usage)</td></tr>
<tr><td>sqs_consumer_rate</td><td>500</td><td>maximum number of workflow start messages the SQS consumer processes per execution</td></tr>
<tr><td>rules.&lt;name&gt;</td><td></td><td>list of cloudwathch rules</td></tr>
<tr><td>rules.&lt;name&gt;.schedule</td><td></td><td>rule's schedule</td></tr>
<tr><td>rules.&lt;name&gt;.state</td><td>ENABLED</td><td>state of the rule</td></tr>
<tr><td>rules.&lt;name&gt;.targets</td><td></td><td>list of lambda functions to be invoked (e.g. <code>- lambda: myFunctionName</code>)</td></tr>
<tr><td>stepFunctions</td><td></td><td>list of step functions</td></tr>
<tr><td>lambdas</td><td></td><td>list of lambda functions</td></tr>
<tr><td>iams</td><td></td><td>(Override) IAM roles if ARNs do not match conventions (See <a href="config_descriptions#iams">below</a>).</td></tr>
<tr><td>&lt;stack&gt;.params</td><td></td><td>(Override) Parameters provided to Cumulus CloudFormation templates.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="detailed-field-descriptions"></a><a href="#detailed-field-descriptions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Detailed Field Descriptions</h2>
<h3><a class="anchor" aria-hidden="true" id="deployment-name-key"></a><a href="#deployment-name-key" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deployment name (key)</h3>
<p>The name (e.g. <code>dev:</code>) of the the 'deployment' - this key tells kes which configuration set (in addition to the default values) to use when creating the cloud formation template<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<h3><a class="anchor" aria-hidden="true" id="prefix"></a><a href="#prefix" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>prefix</h3>
<p>This value (e.g. <code>prefix: myPrefix</code>) will prefix CloudFormation-created resources and permissions.</p>
<h3><a class="anchor" aria-hidden="true" id="prefixnodash"></a><a href="#prefixnodash" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>prefixNoDash</h3>
<p>A representation of the stack name prefix that has dashes removed. This will be used for components that should be associated with the stack but do not allow dashes in the identifier.</p>
<h3><a class="anchor" aria-hidden="true" id="buckets"></a><a href="#buckets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>buckets</h3>
<p>The buckets should map to the same names you used when creating buckets in the <a href="deployment-readme#create-s3-buckets">Create S3 Buckets</a> step. Buckets are defined in the config.yml with a key, name, and type. Types should be one of: internal, public, private, or protected. Multiple buckets of each type can be configured. A key is used for the buckets to allow for swapping out the bucket names easily.</p>
<h3><a class="anchor" aria-hidden="true" id="usengappermissionboundary"></a><a href="#usengappermissionboundary" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>useNgapPermissionBoundary</h3>
<p>If deploying to a NASA NGAP account, set <code>useNgapPermissionBoundary: true</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="vpc"></a><a href="#vpc" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>vpc</h3>
<p>Configure your virtual private cloud.  You can find the VPC Id, subnets, and security group values on the <a href="https://console.aws.amazon.com/vpc/home?region=us-east-1#">VPC Dashboard</a>. <code>vpcId</code> from <a href="https://console.aws.amazon.com/vpc/home?region=us-east-1#vpcs:">Your VPCs</a>, and <code>subnets</code> <a href="https://console.aws.amazon.com/vpc/home?region=us-east-1#subnets:">here</a>. When you choose a subnet, be sure to also note its availability zone, which is used to configure <code>ecs</code>. The security group MUST allow HTTP(S) traffic (port 443). Optionally, SSH traffic should be allowed to SSH into ECS instances.</p>
<p>Note: The console links are specific to <code>us-east-1</code>. Use the corresponding links for your region.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">  vpc:</span>
<span class="hljs-attr">    vpcId:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{VPC_ID}}</span>'</span>                 <span class="hljs-comment"># this has to be set in .env</span>
<span class="hljs-attr">    subnets:</span>
<span class="hljs-bullet">      -</span> <span class="hljs-string">'<span class="hljs-template-variable">{{AWS_SUBNET}}</span>'</span>                <span class="hljs-comment"># this has to be set in .env</span>
<span class="hljs-attr">    securityGroup:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{SECURITY_GROUP}}</span>'</span> <span class="hljs-comment"># this has to be set in .env</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="cmr"></a><a href="#cmr" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cmr</h3>
<p>Configuration is required for Cumulus integration with CMR services. The most obvious example of this integration is the <code>PostToCmr</code> Cumulus <a href="https://github.com/nasa/cumulus/tree/master/tasks/post-to-cmr">task</a>.</p>
<p>CMR uses Earthdata Login system or Launchpad system for authentication. We can configure Cumulus to use one of the systems for CMR authentication.</p>
<p>To configure Cumulus to use Earthdata Login system for authentication, ensure your CMR username/password is included in your <code>app/.env</code> file, as noted in the <a href="./deployment-readme">deployment documentation</a>:</p>
<pre><code class="hljs css language-shell">CMR_USERNAME=cmruser
CMR_PASSWORD=cmrpassword
</code></pre>
<p>These values will be imported via kes in your configuration file.   You should ensure your <code>app/config.yml</code> contains the following lines:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">cmr:</span>
<span class="hljs-attr">  username:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{CMR_USERNAME}}</span>'</span>
<span class="hljs-attr">  provider:</span> <span class="hljs-string">'&lt;replace-with-cmr-provider&gt;'</span>
<span class="hljs-attr">  clientId:</span> <span class="hljs-string">'&lt;replace-with-daac-name&gt;-<span class="hljs-template-variable">{{prefix}}</span>'</span>
<span class="hljs-attr">  password:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{CMR_PASSWORD}}</span>'</span>
</code></pre>
<p><code>clientId</code> and <code>provider</code> should be configured to point to a user specified CMR <code>clientId</code> and <code>provider</code>. We use the <code>CUMULUS</code> provider in our configurations, but users can specify their own.</p>
<h3><a class="anchor" aria-hidden="true" id="launchpad"></a><a href="#launchpad" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>launchpad</h3>
<p>Cumulus supports Launchpad as the authentication provider for CMR authentication and Cumulus API authentication.</p>
<p>To use Launchpad for authentication, ensure your Launchpad Certificate passphrase is included in your <code>app/.env</code> file, as noted in the <a href="./deployment-readme">deployment documentation</a>:</p>
<pre><code class="hljs css language-shell">LAUNCHPAD_PASSPHRASE=launchpadpassphrase
</code></pre>
<p>These values will be imported via kes in your configuration file.   You should ensure your <code>app/config.yml</code> contains the following lines:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">launchpad:</span>
<span class="hljs-attr">  api:</span> <span class="hljs-string">'&lt;replace-with-launchpad-token-service-api&gt;'</span>
<span class="hljs-attr">  passphrase:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{LAUNCHPAD_PASSPHRASE}}</span>'</span>
</code></pre>
<p>To configure Cumulus to use Launchpad system for CMR authentication, follow the steps <a href="./cmr_launchpad_authentication">CMR Launchpad Authentication</a> to setup CMR client and configure Cumulus.</p>
<h3><a class="anchor" aria-hidden="true" id="users"></a><a href="#users" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>users</h3>
<p>List of EarthData users you wish to have access to your dashboard application. These users will be populated in your <code>&lt;prefix&gt;-UsersTable</code> <a href="https://console.aws.amazon.com/dynamodb/">DynamoDb</a> table.</p>
<h3><a class="anchor" aria-hidden="true" id="ecs"></a><a href="#ecs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ecs</h3>
<p>Configuration for the Amazon EC2 Container Service (ECS) instance.  Update <code>availabilityZone</code> (or <code>availabilityZones</code> if using multiple AZs) with information from <a href="https://console.aws.amazon.com/vpc/home?region=us-east-1#">VPC Dashboard</a>
note <code>instanceType</code> and <code>desiredInstances</code> have been selected for a sample install.  You will have to specify appropriate values to deploy and use ECS machines.   See <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html">EC2 Instance Types</a> for more information.</p>
<p>Also note, if you dont specify the <code>amiid</code>, it will try to use a default, which
may or may not exist. The default AMI is an NGAP-approved AMI. The most recent
NGAP AMI can be found using
<a href="https://wiki.earthdata.nasa.gov/display/ESKB/Select+an+NGAP+Created+AMI">these instructions</a>.</p>
<p>For each service, a TaskCountLowAlarm alarm is added to check the RUNNING Task Count against the service configuration.  You can update <code>ecs</code> properties and add additional ECS alarms to your service.  For example,</p>
<pre><code class="hljs">ecs:
  services:
    EcsTaskHelloWorld:
      alarms:
        TaskCountHigh:
          alarm_description: 'There are more tasks running than the desired'
          comparison_operator: GreaterThanThreshold
          evaluation_periods: 1
          metric: MemoryUtilization
          statistic: SampleCount
          threshold: '{{ecs.services.EcsTaskHelloWorld.count}}'
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="cluster-autoscaling"></a><a href="#cluster-autoscaling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cluster AutoScaling</h4>
<p>Cumulus ECS clusters have the ability to scale out and in based on
<a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/cloudwatch-metrics.html#cluster_reservation">CPU and memory reservations</a>.
There are a few configuration values that affect how the ECS cluster instances
scale:</p>
<ul>
<li><code>ecs.clusterAutoscaling.scaleInThresholdPercent</code>: the reservation percentage
where, if both CPU and memory are under, the EC2 cluster will be scaled in</li>
<li><code>ecs.clusterAutoscaling.scaleInAdjustmentPercent</code>: the percentage to increase
or decrease the number of EC2 instances in the cluster when the &quot;scale in&quot;
alarm is triggered. Since this is a &quot;scale in&quot; setting, it should typically be
a negative value. For more information see the
<a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-scaling-simple-step.html#as-scaling-adjustment">PercentChangeInCapacity documentation</a>,
specifically the section on <code>PercentChangeInCapacity</code>.</li>
<li><code>ecs.clusterAutoscaling.scaleOutThresholdPercent</code>: the reservation percentage
where, if both CPU and memory are under, the EC2 cluster will be scaled out</li>
<li><code>ecs.clusterAutoscaling.scaleOutAdjustmentPercent</code>: the percentage to increase
or decrease the number of EC2 instances in the cluster when the &quot;scale out&quot;
alarm is triggered. Since this is a &quot;scale out&quot; setting, it should typically
be a positive value. For more information see the
<a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-scaling-simple-step.html#as-scaling-adjustment">PercentChangeInCapacity documentation</a>,
specifically the section on <code>PercentChangeInCapacity</code>.</li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Defaults</span>
<span class="hljs-attr">ecs:</span>
<span class="hljs-attr">  clusterAutoscaling:</span>
<span class="hljs-attr">    scaleInThresholdPercent:</span> <span class="hljs-number">25</span>
<span class="hljs-attr">    scaleInAdjustmentPercent:</span> <span class="hljs-bullet">-5</span>
<span class="hljs-attr">    scaleOutThresholdPercent:</span> <span class="hljs-number">75</span>
<span class="hljs-attr">    scaleOutAdjustmentPercent:</span> <span class="hljs-number">10</span>
</code></pre>
<p>The default behavior is that, if more than 75% of your cluster's CPU or memory
has been reserved, the size of the cluster will be increased by 10%. (There is a
minimum change of 1 instance.) If <em>both</em> CPU and memory reservation for the
cluster are under 25%, then the cluster size will be reduced by 5%.</p>
<h4><a class="anchor" aria-hidden="true" id="service-autoscaling"></a><a href="#service-autoscaling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Service AutoScaling</h4>
<p>Cumulus supports automatically scaling the number of tasks configured for an ECS
service. The scaling of tasks is based on the <code>ActivityScheduleTime</code> metric,
which measures how long (in milliseconds) an activity waited before being picked
up for processing. If the average activity is waiting more than the configured
<code>scaleOutActivityScheduleTime</code> time, then additional tasks will be added to the
service. If the average activity is waiting less than the configured
<code>scaleInActivityScheduleTime</code> time, then tasks will be removed from the service.
Ideally, the average wait time for tasks should settle somewhere between
<code>scaleInActivityScheduleTime</code> and <code>scaleOutActivityScheduleTime</code>.</p>
<p>Configuration values that affect ECS service autoscaling. These would all be
defined for a specific service.</p>
<ul>
<li><code>minTasks</code>: the minimum number of tasks to maintain in a service</li>
<li><code>maxTasks</code>: the maximum number of tasks to maintain in a service</li>
<li><code>scaleInAdjustmentPercent</code>: the percentage to increase or decrease the number
of tasks in the cluster by when the &quot;scale in&quot; alarm is triggered. Since this
is a &quot;scale in&quot; setting, it should typically be a negative value. For more
information see the
<a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-scaling-simple-step.html#as-scaling-adjustment">PercentChangeInCapacity documentation</a>,
specifically the section on <code>PercentChangeInCapacity</code>.</li>
<li><code>scaleInActivityScheduleTime</code>: a duration in milliseconds. If the average task
is waiting for less than this amount of time before being started, then the
number of tasks configured for the service will be reduced</li>
<li><code>scaleOutAdjustmentPercent</code>: the percentage to increase or decrease the number
of tasks in the cluster by when the &quot;scale out&quot; alarm is triggered. Since this
is a &quot;scale out&quot; setting, it should typically be a negative value. For more
information see the
<a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-scaling-simple-step.html#as-scaling-adjustment">PercentChangeInCapacity documentation</a>,
specifically the section on <code>PercentChangeInCapacity</code>.
<ul>
<li><code>scaleOutActivityScheduleTime</code>: a duration in milliseconds. If the average
task is waiting for more than this amount of time before being started, then
the number of tasks configured for the service will be increased</li>
</ul></li>
</ul>
<h5><a class="anchor" aria-hidden="true" id="notes"></a><a href="#notes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Notes</h5>
<ul>
<li><code>minTasks</code> and <code>maxTasks</code> are required for autoscaling to be enabled</li>
<li><code>scaleInActivityScheduleTime</code> and <code>scaleInAdjustmentPercent</code> are required for
scaling in to be enabled</li>
<li><code>scaleOutActivityScheduleTime</code> and <code>scaleOutAdjustmentPercent</code> are required
for scaling out to be enabled</li>
<li>When scaling of a service is triggered, the number of tasks will always change
by at least 1, even if the number that would be changed based on the
configured adjustment percent is less than 1.</li>
</ul>
<h5><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h5>
<p>Only auto scaling-related fields are shown in this example config.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">ecs:</span>
<span class="hljs-attr">  services:</span>
<span class="hljs-attr">    ExampleService:</span>
<span class="hljs-attr">      minTasks:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">      maxTasks:</span> <span class="hljs-number">10</span>
<span class="hljs-attr">      scaleInActivityScheduleTime:</span> <span class="hljs-number">5000</span>
<span class="hljs-attr">      scaleInAdjustmentPercent:</span> <span class="hljs-bullet">-5</span>
<span class="hljs-attr">      scaleOutActivityScheduleTime:</span> <span class="hljs-number">10000</span>
<span class="hljs-attr">      scaleOutAdjustmentPercent:</span> <span class="hljs-number">10</span>
</code></pre>
<p>In this example configuration, the minimum number of tasks is 1 and the maximum
is 10. If the average time for activities to be started is less than 5 seconds,
then the number of tasks configured for the service will be reduced by 5%. If
the average time for activities to be started is greater than 10 seconds, then
the number of tasks configured for the service will be increased by 10%.
Eventually, the average time that a task takes to start should hover between 5
and 10 seconds.</p>
<h3><a class="anchor" aria-hidden="true" id="es"></a><a href="#es" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>es</h3>
<p>Configuration for the Amazon Elasticsearch Service (ES) instance. Optional. Set <code>es: null</code> to disable ElasticSearch.</p>
<p>VPC note: When using Amazon ElasticSearch Service in a VPC run <code>aws iam create-service-linked-role --aws-service-name es.amazonaws.com</code> before deploying. This operation only needs to be done once per account.</p>
<p>You can update <code>es</code> properties and add additional ES alarms. For example:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">  es:</span>
<span class="hljs-attr">    instanceCount:</span> <span class="hljs-number">2</span>
<span class="hljs-attr">    alarms:</span>
<span class="hljs-attr">      NodesHigh:</span>
<span class="hljs-attr">        alarm_description:</span> <span class="hljs-string">'There are more instances running than the desired'</span>
<span class="hljs-attr">        comparison_operator:</span> <span class="hljs-string">GreaterThanThreshold</span>
<span class="hljs-attr">        threshold:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{es.instanceCount}}</span>'</span>
<span class="hljs-attr">        metric:</span> <span class="hljs-string">Nodes</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="sns"></a><a href="#sns" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>sns</h3>
<p>Cumulus supports configuration and deployment of SNS topics and subscribers using <code>app/config.yml</code>. In the following code snippets we'll see an example topic and subscriber configuration.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">sns:</span>
  <span class="hljs-comment"># this topic receives all the updates from</span>
  <span class="hljs-comment"># step functions</span>
<span class="hljs-attr">  sftracker:</span>
<span class="hljs-attr">    subscriptions:</span>
<span class="hljs-attr">      lambda:</span>
<span class="hljs-attr">        endpoint:</span>
<span class="hljs-attr">          function:</span> <span class="hljs-attr">Fn::GetAtt</span>
<span class="hljs-attr">          array:</span>
<span class="hljs-bullet">            -</span> <span class="hljs-string">sns2elasticsearchLambdaFunction</span>
<span class="hljs-bullet">            -</span> <span class="hljs-string">Arn</span>
<span class="hljs-attr">        protocol:</span> <span class="hljs-string">lambda</span>
</code></pre>
<p>The above code is an example of configuration for an SNS topic that will be called <code>sftrackerSns</code> in the resulting <code>cloudformation.yml</code> file. Upon deployment, this configuration creates an SNS topic named <code>&lt;prefix&gt;-sftracker</code> and subscribes the resource named <code>sns2elasticsearchLambdaFunction</code> to that topic so that it will be triggered when any messages are added to that topic.</p>
<p>More information for each of the individual attributes can be found in <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html">AWS SNS Topic Documentation</a>.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">sns:</span> <span class="hljs-string">...</span>
<span class="hljs-attr">  sftrackerSubscription:</span>
<span class="hljs-attr">    arn:</span>
<span class="hljs-attr">      Fn:</span><span class="hljs-string">:GetAtt:</span>
<span class="hljs-bullet">        -</span> <span class="hljs-string">sftrackerSns</span>
<span class="hljs-bullet">        -</span> <span class="hljs-string">Arn</span>
<span class="hljs-attr">      endpoint:</span>
<span class="hljs-attr">        function:</span> <span class="hljs-attr">Fn::GetAtt</span>
<span class="hljs-attr">          array:</span>
<span class="hljs-bullet">            -</span> <span class="hljs-string">someOtherLambdaFunction</span>
<span class="hljs-bullet">            -</span> <span class="hljs-string">Arn</span>
<span class="hljs-attr">        protocol:</span> <span class="hljs-string">lambda</span>
</code></pre>
<p>This snippet is an example of configuration for a list of SNS Subscriptions. We are adding an existing lambda function (<code>someOtherLambdaFunction</code>) as a subscriber to an existing SNS Topic (<code>sfTrackerSns</code>). That is, this configuration assumes that the <code>sftrackerSns</code> Topic is configured elsewhere (as shown above) and that the definition of a lambda function, <code>someOtherLambdaFunction</code>, is in your configuration.</p>
<p>The main difference between this and the previous example is the inclusion of the <code>sns.arn</code> attribute - this tells our deployment/compiling step that we're configuring subscriptions, not a new topic. More information for each of the individual attributes can be found in <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sns-subscription.html">AWS SNS Subscription Documentation</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="iams"></a><a href="#iams" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>iams</h3>
<p>Optional. Overrides allowed if your IAM role ARNs do not match the following convention used in <code>@cumulus/deployment/app/config.yml</code>:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">  iams:</span>
<span class="hljs-attr">    ecsRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-ecs'</span>
<span class="hljs-attr">    lambdaApiGatewayRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-lambda-api-gateway'</span>
<span class="hljs-attr">    lambdaProcessingRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-lambda-processing'</span>
<span class="hljs-attr">    stepRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-steprole'</span>
<span class="hljs-attr">    instanceProfile:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:instance-profile/<span class="hljs-template-variable">{{prefix}}</span>-ecs'</span>
<span class="hljs-attr">    distributionRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-distribution-api-lambda'</span>
<span class="hljs-attr">    scalingRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-scaling-role'</span>
<span class="hljs-attr">    migrationRoleArn:</span> <span class="hljs-string">'arn:aws:iam::<span class="hljs-template-variable">{{AWS_ACCOUNT_ID}}</span>:role/<span class="hljs-template-variable">{{prefix}}</span>-migration-processing'</span>
</code></pre>
<p>To override, add the ARNs for each of the seven roles and one instanceProfile created in the <a href="create-iam-roles">Create IAM Roles</a> step. You can retrieve the ARNs from:</p>
<pre><code class="hljs">$ aws iam list-roles | grep Arn
$ aws iam list-instance-profiles | grep Arn
</code></pre>
<p>For information on how to locate them in the Console see <a href="/cumulus/docs/deployment/iam_roles">Locating Cumulus IAM Roles</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="apiconfigs"></a><a href="#apiconfigs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>apiConfigs</h2>
<p>Use the apiConfigs to configure <a href="https://aws.amazon.com/blogs/compute/introducing-amazon-api-gateway-private-endpoints/">private endpoints in API Gateway</a>. The key for <code>apiConfigs</code> should be <code>backend</code> or <code>distribution</code>. To deploy a private API Gateway, set <code>private: true</code>. The <code>port</code> option can be set if you would like to configure tunneling via a certain port.</p>
<p>Example:</p>
<pre><code class="hljs"><span class="hljs-attr">apiConfigs:</span>
<span class="hljs-attr">  backend:</span>
<span class="hljs-attr">    private:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">    port:</span> <span class="hljs-number">8000</span>
<span class="hljs-attr">  distribution:</span>
<span class="hljs-attr">    private:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">    port:</span> <span class="hljs-number">7000</span>
</code></pre>
<p><strong>Note:</strong> If you deploy a private API Gateway and you want to go back to public (Edge), that will not work via the deployment since AWS does not allow you to convert a private API Gateway to public. The easiest way is to follow the steps in <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-api-migration.html">this document</a> to switch your endpoint configuration to <code>Regional</code>, then to <code>Edge</code> using either the AWS Console or the CLI. Then you can redeploy with the <code>private: true</code> option removed.</p>
<h1><a class="anchor" aria-hidden="true" id="footnotes"></a><a href="#footnotes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Footnotes</h1>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1"  class="footnote-item"><p>This value is used by kes only to identify the configuration set to use and should not appear in any AWS object <a href="#fnref1" class="footnote-backref">↩</a></p>
</li>
</ol>
</section>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/cumulus/docs/deployment/obtain_cumulus_packages"><span class="arrow-prev">← </span><span>Obtaining Cumulus Packages</span></a><a class="docs-next button" href="/cumulus/docs/deployment/cmr_launchpad_authentication"><span>CMR Launchpad Authentication</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#overview">Overview</a><ul class="toc-headings"><li><a href="#configyml-requirements">config.yml Requirements</a></li><li><a href="#configyml-explained">config.yml Explained</a></li></ul></li><li><a href="#detailed-field-descriptions">Detailed Field Descriptions</a><ul class="toc-headings"><li><a href="#deployment-name-key">Deployment name (key)</a></li><li><a href="#prefix">prefix</a></li><li><a href="#prefixnodash">prefixNoDash</a></li><li><a href="#buckets">buckets</a></li><li><a href="#usengappermissionboundary">useNgapPermissionBoundary</a></li><li><a href="#vpc">vpc</a></li><li><a href="#cmr">cmr</a></li><li><a href="#launchpad">launchpad</a></li><li><a href="#users">users</a></li><li><a href="#ecs">ecs</a></li><li><a href="#es">es</a></li><li><a href="#sns">sns</a></li><li><a href="#iams">iams</a></li></ul></li><li><a href="#apiconfigs">apiConfigs</a></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f7e0be879553661f9043322d119069c8',
                indexName: 'nasa_cumulus',
                inputSelector: '#search_input_react'
              });
            </script></body></html>